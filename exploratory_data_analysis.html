<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MA [46]15 Final Project Team 6 – exploratory_data_analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MA [46]15 Final Project Team 6</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./big_picture.html" rel="" target="">
 <span class="menu-text">Big Picture</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./analysis.html" rel="" target="">
 <span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data.html" rel="" target="">
 <span class="menu-text">Data</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"dataset/nypd_shooting_clean.rds"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the dataset</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
  INCIDENT_KEY OCCUR_DATE BORO     PRECINCT JURISDICTION_CODE LOC_CLASSFCTN_DESC
         &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt;             &lt;dbl&gt; &lt;chr&gt;             
1    243566884 04/12/2022 BRONX          49                 0 STREET            
2    256484816 12/17/2022 BRONX          52                 0 STREET            
3    250216145 08/27/2022 BRONX          44                 0 VEHICLE           
4    239207164 01/15/2022 QUEENS        113                 2 HOUSING           
5    248013313 07/14/2022 BROOKLYN       77                 0 DWELLING          
6    247542571 07/04/2022 BRONX          48                 0 STREET            
# ℹ 13 more variables: LOCATION_DESC &lt;chr&gt;, STATISTICAL_MURDER_FLAG &lt;lgl&gt;,
#   PERP_AGE_GROUP &lt;chr&gt;, PERP_SEX &lt;chr&gt;, PERP_RACE &lt;chr&gt;, VIC_AGE_GROUP &lt;chr&gt;,
#   VIC_SEX &lt;chr&gt;, VIC_RACE &lt;chr&gt;, X_COORD_CD &lt;dbl&gt;, Y_COORD_CD &lt;dbl&gt;,
#   Latitude &lt;dbl&gt;, Longitude &lt;dbl&gt;, Lon_Lat &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary statistics</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  INCIDENT_KEY        OCCUR_DATE            BORO              PRECINCT     
 Min.   :238531159   Length:1706        Length:1706        Min.   :  1.00  
 1st Qu.:243566417   Class :character   Class :character   1st Qu.: 42.00  
 Median :247200780   Mode  :character   Mode  :character   Median : 60.00  
 Mean   :247286170                                         Mean   : 62.14  
 3rd Qu.:250665115                                         3rd Qu.: 79.00  
 Max.   :261190187                                         Max.   :123.00  
 JURISDICTION_CODE LOC_CLASSFCTN_DESC LOCATION_DESC     
 Min.   :0.0000    Length:1706        Length:1706       
 1st Qu.:0.0000    Class :character   Class :character  
 Median :0.0000    Mode  :character   Mode  :character  
 Mean   :0.2585                                         
 3rd Qu.:0.0000                                         
 Max.   :2.0000                                         
 STATISTICAL_MURDER_FLAG PERP_AGE_GROUP       PERP_SEX        
 Mode :logical           Length:1706        Length:1706       
 FALSE:1368              Class :character   Class :character  
 TRUE :338               Mode  :character   Mode  :character  
                                                              
                                                              
                                                              
  PERP_RACE         VIC_AGE_GROUP        VIC_SEX            VIC_RACE        
 Length:1706        Length:1706        Length:1706        Length:1706       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
   X_COORD_CD        Y_COORD_CD        Latitude       Longitude     
 Min.   : 929510   Min.   :127539   Min.   :40.52   Min.   :-74.20  
 1st Qu.:1000227   1st Qu.:184263   1st Qu.:40.67   1st Qu.:-73.94  
 Median :1008245   Median :210147   Median :40.74   Median :-73.91  
 Mean   :1009397   Mean   :211643   Mean   :40.75   Mean   :-73.91  
 3rd Qu.:1016866   3rd Qu.:241412   3rd Qu.:40.83   3rd Qu.:-73.88  
 Max.   :1059828   Max.   :269204   Max.   :40.91   Max.   :-73.73  
   Lon_Lat         
 Length:1706       
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'OCCUR_DATE' to datetime format</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OCCUR_DATE =</span> <span class="fu">dmy</span>(OCCUR_DATE), </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">OCCUR_YEAR =</span> <span class="fu">year</span>(OCCUR_DATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `OCCUR_DATE = dmy(OCCUR_DATE)`.
Caused by warning:
!  1017 failed to parse.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>NYPD_arrest_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"dataset/nypd_arrest.rds"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(data, NYPD_arrest_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"X_COORD_CD"</span>, <span class="st">"Y_COORD_CD"</span>,<span class="st">"Latitude"</span>,<span class="st">"Longitude"</span>,<span class="st">"PERP_SEX"</span>,<span class="st">"JURISDICTION_CODE"</span>,<span class="st">"PERP_RACE"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Geographical Heatmap: Concentration of shootings in different boroughs</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>borough_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(BORO) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(borough_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(BORO, n), <span class="at">y =</span> n, <span class="at">fill =</span> BORO)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Number of Shootings by Borough'</span>, <span class="at">x =</span> <span class="st">'Borough'</span>, <span class="at">y =</span> <span class="st">'Number of Shootings'</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perpetrator and Victim Demographics: Age Group Distribution</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>perp_age_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(PERP_AGE_GROUP) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>vic_age_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(VIC_AGE_GROUP) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting Perpetrator Age Group Distribution</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(perp_age_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(PERP_AGE_GROUP, n), <span class="at">y =</span> n, <span class="at">fill =</span> PERP_AGE_GROUP)) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Perpetrator Age Group Distribution'</span>, <span class="at">x =</span> <span class="st">'Age Group'</span>, <span class="at">y =</span> <span class="st">'Count'</span>) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting Victim Age Group Distribution</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vic_age_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(VIC_AGE_GROUP, n), <span class="at">y =</span> n, <span class="at">fill =</span> VIC_AGE_GROUP)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Victim Age Group Distribution'</span>, <span class="at">x =</span> <span class="st">'Age Group'</span>, <span class="at">y =</span> <span class="st">'Count'</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure we're working with the numeric part of the dataset</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#numeric_data &lt;- data %&gt;% </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select_if(is.numeric)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the correlation matrix, handling NA values by computing correlations for complete pairs</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#cor_matrix &lt;- cor(numeric_data, use = "pairwise.complete.obs")</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the correlation matrix using ggcorrplot</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#ggcorrplot(cor_matrix, method = "circle", type = "lower", </span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>           <span class="co">#lab = TRUE, lab_size = 3, tl.cex = 10, tl.col = "black",</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>           <span class="co">#title = "Correlation Matrix of Numeric Variables")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># STILL WORKING ON IT</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data, aes(x = variable1, y = variable2)) +</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point() +</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Scatter Plot of variable1 vs. variable2",</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "variable1",</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "variable2")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># STILL WORKING ON IT</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data, aes(x = variable)) +</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_histogram(bins = 30, fill = "blue", color = "black") +</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Histogram of variable",</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "variable",</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "Frequency")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># STILL WORKING ON IT</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Linear regression model </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_model &lt;- lm(variable1 ~ variable2, data = data)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Summarize the model</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_model)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>prep_race_counts <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(PERP_RACE) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prep_race_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(PERP_RACE, n), <span class="at">y =</span> n, <span class="at">fill =</span> PERP_RACE)) <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Perpetrator Race Distribution"</span>, <span class="at">x =</span> <span class="st">"Perpetrator Race"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>vic_race_counts <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(VIC_RACE) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vic_race_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(VIC_RACE, n), <span class="at">y =</span> n, <span class="at">fill =</span> VIC_RACE)) <span class="sc">+</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Victim Race Distribution"</span>, <span class="at">x =</span> <span class="st">"Victim Race"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportions Blog Post 4</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PERP_RACE) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Proportion =</span> <span class="fu">mean</span>(STATISTICAL_MURDER_FLAG <span class="sc">==</span> <span class="st">"TRUE"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proportions, <span class="fu">aes</span>(<span class="at">x =</span> PERP_RACE, <span class="at">y =</span> Proportion, <span class="at">fill =</span> PERP_RACE)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proportion of Incidents Classified as Statistical Murders by Perpetrator Race"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Perpetrator Race"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(STATISTICAL_MURDER_FLAG <span class="sc">~</span> BORO <span class="sc">+</span> PERP_SEX <span class="sc">+</span> PERP_RACE <span class="sc">+</span> LOC_CLASSFCTN_DESC <span class="sc">+</span> PERP_AGE_GROUP <span class="sc">+</span> VIC_SEX <span class="sc">+</span> VIC_AGE_GROUP <span class="sc">+</span> VIC_RACE <span class="sc">+</span> OFNS_DESC,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> combined_df, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = STATISTICAL_MURDER_FLAG ~ BORO + PERP_SEX + PERP_RACE + 
    LOC_CLASSFCTN_DESC + PERP_AGE_GROUP + VIC_SEX + VIC_AGE_GROUP + 
    VIC_RACE + OFNS_DESC, family = "binomial", data = combined_df)

Coefficients: (1 not defined because of singularities)
                                          Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                              -13.46172 3956.17989  -0.003 0.997285
BOROBROOKLYN                              -0.80477    0.13545  -5.941 2.83e-09
BOROMANHATTAN                             -0.65836    0.14170  -4.646 3.38e-06
BOROQUEENS                                -1.17328    0.20758  -5.652 1.58e-08
BOROSTATEN ISLAND                         -0.01359    0.27812  -0.049 0.961024
PERP_SEXM                                  0.78206    0.49461   1.581 0.113837
PERP_RACEBLACK                            -6.63825    1.47659  -4.496 6.94e-06
PERP_RACEBLACK HISPANIC                   -6.85784    1.50201  -4.566 4.98e-06
PERP_RACEWHITE                           -23.30150 1306.79230  -0.018 0.985774
PERP_RACEWHITE HISPANIC                   -6.87887    1.48095  -4.645 3.40e-06
LOC_CLASSFCTN_DESCDWELLING                -1.68901    0.24849  -6.797 1.07e-11
LOC_CLASSFCTN_DESCHOUSING                 -1.85224    0.22609  -8.192 2.56e-16
LOC_CLASSFCTN_DESCOTHER                  -18.10176  501.30824  -0.036 0.971195
LOC_CLASSFCTN_DESCPARKING LOT             -2.99401    1.13072  -2.648 0.008100
LOC_CLASSFCTN_DESCPLAYGROUND              -0.10074    0.57802  -0.174 0.861643
LOC_CLASSFCTN_DESCSTREET                  -1.75346    0.16836 -10.415  &lt; 2e-16
LOC_CLASSFCTN_DESCTRANSIT                  0.01694    0.56825   0.030 0.976223
LOC_CLASSFCTN_DESCVEHICLE                  3.12812    1.19854   2.610 0.009056
PERP_AGE_GROUP18-24                        1.01082    0.21083   4.794 1.63e-06
PERP_AGE_GROUP25-44                        0.90139    0.21982   4.101 4.12e-05
PERP_AGE_GROUP45-64                        1.71600    0.28214   6.082 1.19e-09
PERP_AGE_GROUP65+                        -15.59241 1480.31146  -0.011 0.991596
VIC_SEXM                                   0.11046    0.13691   0.807 0.419797
VIC_AGE_GROUP18-24                        -0.11672    0.16516  -0.707 0.479753
VIC_AGE_GROUP25-44                         0.10839    0.16574   0.654 0.513133
VIC_AGE_GROUP45-64                        -0.72013    0.23827  -3.022 0.002508
VIC_AGE_GROUP65+                         -16.12617  772.45779  -0.021 0.983344
VIC_AGE_GROUPUNKNOWN                     -12.40332 1895.20904  -0.007 0.994778
VIC_RACEBLACK                              4.03840    1.06956   3.776 0.000160
VIC_RACEBLACK HISPANIC                     3.70554    1.08523   3.415 0.000639
VIC_RACEUNKNOWN                                 NA         NA      NA       NA
VIC_RACEWHITE                              1.99505    1.14311   1.745 0.080936
VIC_RACEWHITE HISPANIC                     3.65555    1.07554   3.399 0.000677
OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW   -1.08311 4822.63674   0.000 0.999821
OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES     15.38200 3956.17971   0.004 0.996898
OFNS_DESCBURGLAR'S TOOLS                  16.70648 3956.18000   0.004 0.996631
OFNS_DESCBURGLARY                         15.11783 3956.17973   0.004 0.996951
OFNS_DESCCANNABIS RELATED OFFENSES        -1.33631 4687.49612   0.000 0.999773
OFNS_DESCCHILD ABANDONMENT/NON SUPPORT    -1.76276 5594.88344   0.000 0.999749
OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF   15.33409 3956.17972   0.004 0.996907
OFNS_DESCCRIMINAL TRESPASS                14.68517 3956.17976   0.004 0.997038
OFNS_DESCDANGEROUS DRUGS                  15.37328 3956.17971   0.004 0.996900
OFNS_DESCDANGEROUS WEAPONS                15.26705 3956.17972   0.004 0.996921
OFNS_DESCFELONY ASSAULT                   14.82937 3956.17972   0.004 0.997009
OFNS_DESCFOR OTHER AUTHORITIES            14.73316 3956.17976   0.004 0.997029
OFNS_DESCFORGERY                          12.13051 3956.17996   0.003 0.997554
OFNS_DESCFRAUDS                           -1.04425 4084.60349   0.000 0.999796
OFNS_DESCGAMBLING                         15.66656 3956.17977   0.004 0.996840
OFNS_DESCGRAND LARCENY                    14.92729 3956.17973   0.004 0.996989
OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE   16.53692 3956.17975   0.004 0.996665
OFNS_DESCHARRASSMENT 2                     3.19031 4845.31117   0.001 0.999475
OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE    3.19031 4845.31117   0.001 0.999475
OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING   15.52000 3956.17977   0.004 0.996870
OFNS_DESCINTOXICATED/IMPAIRED DRIVING     -0.84856 5594.88344   0.000 0.999879
OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES    -0.52635 5594.88345   0.000 0.999925
OFNS_DESCMISCELLANEOUS PENAL LAW          15.32177 3956.17972   0.004 0.996910
OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE    0.42525 3999.93241   0.000 0.999915
OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY     15.16609 3956.17980   0.004 0.996941
OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;    15.76131 3956.17974   0.004 0.996821
OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI   15.33879 3956.17972   0.004 0.996906
OFNS_DESCOFFENSES AGAINST THE PERSON      14.35025 3956.17979   0.004 0.997106
OFNS_DESCOFFENSES INVOLVING FRAUD         15.13177 3956.17973   0.004 0.996948
OFNS_DESCOTHER OFFENSES RELATED TO THEF   16.20625 3956.17976   0.004 0.996732
OFNS_DESCOTHER STATE LAWS                 15.56017 3956.17989   0.004 0.996862
OFNS_DESCOTHER STATE LAWS (NON PENAL LA   -0.94028 4844.51018   0.000 0.999845
OFNS_DESCOTHER TRAFFIC INFRACTION         15.79269 3956.17974   0.004 0.996815
OFNS_DESCPETIT LARCENY                    13.71176 3956.17972   0.003 0.997235
OFNS_DESCPOSSESSION OF STOLEN PROPERTY    15.80920 3956.17974   0.004 0.996812
OFNS_DESCRAPE                             15.63081 3956.17972   0.004 0.996848
OFNS_DESCROBBERY                          15.76949 3956.17972   0.004 0.996820
OFNS_DESCSEX CRIMES                       15.05818 3956.17971   0.004 0.996963
OFNS_DESCUNAUTHORIZED USE OF A VEHICLE    14.81084 3956.17986   0.004 0.997013
OFNS_DESCVEHICLE AND TRAFFIC LAWS         15.45099 3956.17972   0.004 0.996884
                                           
(Intercept)                                
BOROBROOKLYN                            ***
BOROMANHATTAN                           ***
BOROQUEENS                              ***
BOROSTATEN ISLAND                          
PERP_SEXM                                  
PERP_RACEBLACK                          ***
PERP_RACEBLACK HISPANIC                 ***
PERP_RACEWHITE                             
PERP_RACEWHITE HISPANIC                 ***
LOC_CLASSFCTN_DESCDWELLING              ***
LOC_CLASSFCTN_DESCHOUSING               ***
LOC_CLASSFCTN_DESCOTHER                    
LOC_CLASSFCTN_DESCPARKING LOT           ** 
LOC_CLASSFCTN_DESCPLAYGROUND               
LOC_CLASSFCTN_DESCSTREET                ***
LOC_CLASSFCTN_DESCTRANSIT                  
LOC_CLASSFCTN_DESCVEHICLE               ** 
PERP_AGE_GROUP18-24                     ***
PERP_AGE_GROUP25-44                     ***
PERP_AGE_GROUP45-64                     ***
PERP_AGE_GROUP65+                          
VIC_SEXM                                   
VIC_AGE_GROUP18-24                         
VIC_AGE_GROUP25-44                         
VIC_AGE_GROUP45-64                      ** 
VIC_AGE_GROUP65+                           
VIC_AGE_GROUPUNKNOWN                       
VIC_RACEBLACK                           ***
VIC_RACEBLACK HISPANIC                  ***
VIC_RACEUNKNOWN                            
VIC_RACEWHITE                           .  
VIC_RACEWHITE HISPANIC                  ***
OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW    
OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES      
OFNS_DESCBURGLAR'S TOOLS                   
OFNS_DESCBURGLARY                          
OFNS_DESCCANNABIS RELATED OFFENSES         
OFNS_DESCCHILD ABANDONMENT/NON SUPPORT     
OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF    
OFNS_DESCCRIMINAL TRESPASS                 
OFNS_DESCDANGEROUS DRUGS                   
OFNS_DESCDANGEROUS WEAPONS                 
OFNS_DESCFELONY ASSAULT                    
OFNS_DESCFOR OTHER AUTHORITIES             
OFNS_DESCFORGERY                           
OFNS_DESCFRAUDS                            
OFNS_DESCGAMBLING                          
OFNS_DESCGRAND LARCENY                     
OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE    
OFNS_DESCHARRASSMENT 2                     
OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE    
OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING    
OFNS_DESCINTOXICATED/IMPAIRED DRIVING      
OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES     
OFNS_DESCMISCELLANEOUS PENAL LAW           
OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE    
OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY      
OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;     
OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI    
OFNS_DESCOFFENSES AGAINST THE PERSON       
OFNS_DESCOFFENSES INVOLVING FRAUD          
OFNS_DESCOTHER OFFENSES RELATED TO THEF    
OFNS_DESCOTHER STATE LAWS                  
OFNS_DESCOTHER STATE LAWS (NON PENAL LA    
OFNS_DESCOTHER TRAFFIC INFRACTION          
OFNS_DESCPETIT LARCENY                     
OFNS_DESCPOSSESSION OF STOLEN PROPERTY     
OFNS_DESCRAPE                              
OFNS_DESCROBBERY                           
OFNS_DESCSEX CRIMES                        
OFNS_DESCUNAUTHORIZED USE OF A VEHICLE     
OFNS_DESCVEHICLE AND TRAFFIC LAWS          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 3626.2  on 3671  degrees of freedom
Residual deviance: 2850.5  on 3600  degrees of freedom
AIC: 2994.5

Number of Fisher Scoring iterations: 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: not plotting observations with leverage one:
  942, 1410, 2688, 2985</code></pre>
</div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the logistic regression model</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(STATISTICAL_MURDER_FLAG <span class="sc">~</span> BORO <span class="sc">+</span> PERP_SEX <span class="sc">+</span> PERP_RACE <span class="sc">+</span> LOC_CLASSFCTN_DESC <span class="sc">+</span> PERP_AGE_GROUP <span class="sc">+</span> VIC_SEX <span class="sc">+</span> VIC_AGE_GROUP <span class="sc">+</span> VIC_RACE <span class="sc">+</span> OFNS_DESC, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> combined_df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = STATISTICAL_MURDER_FLAG ~ BORO + PERP_SEX + PERP_RACE + 
    LOC_CLASSFCTN_DESC + PERP_AGE_GROUP + VIC_SEX + VIC_AGE_GROUP + 
    VIC_RACE + OFNS_DESC, family = "binomial", data = combined_df)

Coefficients: (1 not defined because of singularities)
                                          Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                              -13.46172 3956.17989  -0.003 0.997285
BOROBROOKLYN                              -0.80477    0.13545  -5.941 2.83e-09
BOROMANHATTAN                             -0.65836    0.14170  -4.646 3.38e-06
BOROQUEENS                                -1.17328    0.20758  -5.652 1.58e-08
BOROSTATEN ISLAND                         -0.01359    0.27812  -0.049 0.961024
PERP_SEXM                                  0.78206    0.49461   1.581 0.113837
PERP_RACEBLACK                            -6.63825    1.47659  -4.496 6.94e-06
PERP_RACEBLACK HISPANIC                   -6.85784    1.50201  -4.566 4.98e-06
PERP_RACEWHITE                           -23.30150 1306.79230  -0.018 0.985774
PERP_RACEWHITE HISPANIC                   -6.87887    1.48095  -4.645 3.40e-06
LOC_CLASSFCTN_DESCDWELLING                -1.68901    0.24849  -6.797 1.07e-11
LOC_CLASSFCTN_DESCHOUSING                 -1.85224    0.22609  -8.192 2.56e-16
LOC_CLASSFCTN_DESCOTHER                  -18.10176  501.30824  -0.036 0.971195
LOC_CLASSFCTN_DESCPARKING LOT             -2.99401    1.13072  -2.648 0.008100
LOC_CLASSFCTN_DESCPLAYGROUND              -0.10074    0.57802  -0.174 0.861643
LOC_CLASSFCTN_DESCSTREET                  -1.75346    0.16836 -10.415  &lt; 2e-16
LOC_CLASSFCTN_DESCTRANSIT                  0.01694    0.56825   0.030 0.976223
LOC_CLASSFCTN_DESCVEHICLE                  3.12812    1.19854   2.610 0.009056
PERP_AGE_GROUP18-24                        1.01082    0.21083   4.794 1.63e-06
PERP_AGE_GROUP25-44                        0.90139    0.21982   4.101 4.12e-05
PERP_AGE_GROUP45-64                        1.71600    0.28214   6.082 1.19e-09
PERP_AGE_GROUP65+                        -15.59241 1480.31146  -0.011 0.991596
VIC_SEXM                                   0.11046    0.13691   0.807 0.419797
VIC_AGE_GROUP18-24                        -0.11672    0.16516  -0.707 0.479753
VIC_AGE_GROUP25-44                         0.10839    0.16574   0.654 0.513133
VIC_AGE_GROUP45-64                        -0.72013    0.23827  -3.022 0.002508
VIC_AGE_GROUP65+                         -16.12617  772.45779  -0.021 0.983344
VIC_AGE_GROUPUNKNOWN                     -12.40332 1895.20904  -0.007 0.994778
VIC_RACEBLACK                              4.03840    1.06956   3.776 0.000160
VIC_RACEBLACK HISPANIC                     3.70554    1.08523   3.415 0.000639
VIC_RACEUNKNOWN                                 NA         NA      NA       NA
VIC_RACEWHITE                              1.99505    1.14311   1.745 0.080936
VIC_RACEWHITE HISPANIC                     3.65555    1.07554   3.399 0.000677
OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW   -1.08311 4822.63674   0.000 0.999821
OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES     15.38200 3956.17971   0.004 0.996898
OFNS_DESCBURGLAR'S TOOLS                  16.70648 3956.18000   0.004 0.996631
OFNS_DESCBURGLARY                         15.11783 3956.17973   0.004 0.996951
OFNS_DESCCANNABIS RELATED OFFENSES        -1.33631 4687.49612   0.000 0.999773
OFNS_DESCCHILD ABANDONMENT/NON SUPPORT    -1.76276 5594.88344   0.000 0.999749
OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF   15.33409 3956.17972   0.004 0.996907
OFNS_DESCCRIMINAL TRESPASS                14.68517 3956.17976   0.004 0.997038
OFNS_DESCDANGEROUS DRUGS                  15.37328 3956.17971   0.004 0.996900
OFNS_DESCDANGEROUS WEAPONS                15.26705 3956.17972   0.004 0.996921
OFNS_DESCFELONY ASSAULT                   14.82937 3956.17972   0.004 0.997009
OFNS_DESCFOR OTHER AUTHORITIES            14.73316 3956.17976   0.004 0.997029
OFNS_DESCFORGERY                          12.13051 3956.17996   0.003 0.997554
OFNS_DESCFRAUDS                           -1.04425 4084.60349   0.000 0.999796
OFNS_DESCGAMBLING                         15.66656 3956.17977   0.004 0.996840
OFNS_DESCGRAND LARCENY                    14.92729 3956.17973   0.004 0.996989
OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE   16.53692 3956.17975   0.004 0.996665
OFNS_DESCHARRASSMENT 2                     3.19031 4845.31117   0.001 0.999475
OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE    3.19031 4845.31117   0.001 0.999475
OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING   15.52000 3956.17977   0.004 0.996870
OFNS_DESCINTOXICATED/IMPAIRED DRIVING     -0.84856 5594.88344   0.000 0.999879
OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES    -0.52635 5594.88345   0.000 0.999925
OFNS_DESCMISCELLANEOUS PENAL LAW          15.32177 3956.17972   0.004 0.996910
OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE    0.42525 3999.93241   0.000 0.999915
OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY     15.16609 3956.17980   0.004 0.996941
OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;    15.76131 3956.17974   0.004 0.996821
OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI   15.33879 3956.17972   0.004 0.996906
OFNS_DESCOFFENSES AGAINST THE PERSON      14.35025 3956.17979   0.004 0.997106
OFNS_DESCOFFENSES INVOLVING FRAUD         15.13177 3956.17973   0.004 0.996948
OFNS_DESCOTHER OFFENSES RELATED TO THEF   16.20625 3956.17976   0.004 0.996732
OFNS_DESCOTHER STATE LAWS                 15.56017 3956.17989   0.004 0.996862
OFNS_DESCOTHER STATE LAWS (NON PENAL LA   -0.94028 4844.51018   0.000 0.999845
OFNS_DESCOTHER TRAFFIC INFRACTION         15.79269 3956.17974   0.004 0.996815
OFNS_DESCPETIT LARCENY                    13.71176 3956.17972   0.003 0.997235
OFNS_DESCPOSSESSION OF STOLEN PROPERTY    15.80920 3956.17974   0.004 0.996812
OFNS_DESCRAPE                             15.63081 3956.17972   0.004 0.996848
OFNS_DESCROBBERY                          15.76949 3956.17972   0.004 0.996820
OFNS_DESCSEX CRIMES                       15.05818 3956.17971   0.004 0.996963
OFNS_DESCUNAUTHORIZED USE OF A VEHICLE    14.81084 3956.17986   0.004 0.997013
OFNS_DESCVEHICLE AND TRAFFIC LAWS         15.45099 3956.17972   0.004 0.996884
                                           
(Intercept)                                
BOROBROOKLYN                            ***
BOROMANHATTAN                           ***
BOROQUEENS                              ***
BOROSTATEN ISLAND                          
PERP_SEXM                                  
PERP_RACEBLACK                          ***
PERP_RACEBLACK HISPANIC                 ***
PERP_RACEWHITE                             
PERP_RACEWHITE HISPANIC                 ***
LOC_CLASSFCTN_DESCDWELLING              ***
LOC_CLASSFCTN_DESCHOUSING               ***
LOC_CLASSFCTN_DESCOTHER                    
LOC_CLASSFCTN_DESCPARKING LOT           ** 
LOC_CLASSFCTN_DESCPLAYGROUND               
LOC_CLASSFCTN_DESCSTREET                ***
LOC_CLASSFCTN_DESCTRANSIT                  
LOC_CLASSFCTN_DESCVEHICLE               ** 
PERP_AGE_GROUP18-24                     ***
PERP_AGE_GROUP25-44                     ***
PERP_AGE_GROUP45-64                     ***
PERP_AGE_GROUP65+                          
VIC_SEXM                                   
VIC_AGE_GROUP18-24                         
VIC_AGE_GROUP25-44                         
VIC_AGE_GROUP45-64                      ** 
VIC_AGE_GROUP65+                           
VIC_AGE_GROUPUNKNOWN                       
VIC_RACEBLACK                           ***
VIC_RACEBLACK HISPANIC                  ***
VIC_RACEUNKNOWN                            
VIC_RACEWHITE                           .  
VIC_RACEWHITE HISPANIC                  ***
OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW    
OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES      
OFNS_DESCBURGLAR'S TOOLS                   
OFNS_DESCBURGLARY                          
OFNS_DESCCANNABIS RELATED OFFENSES         
OFNS_DESCCHILD ABANDONMENT/NON SUPPORT     
OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF    
OFNS_DESCCRIMINAL TRESPASS                 
OFNS_DESCDANGEROUS DRUGS                   
OFNS_DESCDANGEROUS WEAPONS                 
OFNS_DESCFELONY ASSAULT                    
OFNS_DESCFOR OTHER AUTHORITIES             
OFNS_DESCFORGERY                           
OFNS_DESCFRAUDS                            
OFNS_DESCGAMBLING                          
OFNS_DESCGRAND LARCENY                     
OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE    
OFNS_DESCHARRASSMENT 2                     
OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE    
OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING    
OFNS_DESCINTOXICATED/IMPAIRED DRIVING      
OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES     
OFNS_DESCMISCELLANEOUS PENAL LAW           
OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE    
OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY      
OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;     
OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI    
OFNS_DESCOFFENSES AGAINST THE PERSON       
OFNS_DESCOFFENSES INVOLVING FRAUD          
OFNS_DESCOTHER OFFENSES RELATED TO THEF    
OFNS_DESCOTHER STATE LAWS                  
OFNS_DESCOTHER STATE LAWS (NON PENAL LA    
OFNS_DESCOTHER TRAFFIC INFRACTION          
OFNS_DESCPETIT LARCENY                     
OFNS_DESCPOSSESSION OF STOLEN PROPERTY     
OFNS_DESCRAPE                              
OFNS_DESCROBBERY                           
OFNS_DESCSEX CRIMES                        
OFNS_DESCUNAUTHORIZED USE OF A VEHICLE     
OFNS_DESCVEHICLE AND TRAFFIC LAWS          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 3626.2  on 3671  degrees of freedom
Residual deviance: 2850.5  on 3600  degrees of freedom
AIC: 2994.5

Number of Fisher Scoring iterations: 16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC curve</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(combined_df<span class="sc">$</span>STATISTICAL_MURDER_FLAG, predictions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = FALSE, case = TRUE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_curve)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.7952</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>shapefile_path <span class="ot">&lt;-</span> <span class="st">"tl_2022_36_tract/tl_2022_36_tract.shp"</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> <span class="fu">st_read</span>(shapefile_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tl_2022_36_tract' from data source 
  `/Users/saisriram/Desktop/MA615/Team6/tl_2022_36_tract/tl_2022_36_tract.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 5411 features and 12 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -79.76259 ymin: 40.47658 xmax: -71.77749 ymax: 45.01586
Geodetic CRS:  NAD83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>nyc_tracts <span class="ot">&lt;-</span> complete_data <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COUNTYFP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"005"</span>, <span class="st">"047"</span>, <span class="st">"061"</span>, <span class="st">"081"</span>, <span class="st">"085"</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>map_df <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(combined_df, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitude"</span>, <span class="st">"Latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>, <span class="at">agr =</span> <span class="st">"constant"</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the shapefile for NYC tracts and overlaying points</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> nyc_tracts, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> map_df, <span class="at">color =</span> <span class="st">"brown3"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Adds the points</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Map of New York City with Offense Data Points"</span>, <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the final plot</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(final_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explores relationships between perpetrator and victim demographics</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare perpetrator and victim age groups</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_df, <span class="fu">aes</span>(<span class="at">x =</span> PERP_AGE_GROUP, <span class="at">fill =</span> VIC_AGE_GROUP)) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Perpetrator Age Group"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Victim Age Group"</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Comparison of Perpetrator and Victim Age Groups"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyzing race and gender impact</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_df, <span class="fu">aes</span>(<span class="at">x =</span> PERP_RACE, <span class="at">fill =</span> VIC_SEX)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Perpetrator Race"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Victim Sex"</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Impact of Perpetrator Race on Victim Sex"</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># offense and Perpetrator race correlation</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>combined_df <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(OFNS_DESC) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Count <span class="sc">&gt;=</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> OFNS_DESC, <span class="at">y =</span> Count, <span class="at">fill =</span> OFNS_DESC)) <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Offense Description"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as
of ggplot2 3.3.4.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(OFNS_DESC, PERP_RACE) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Count <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> OFNS_DESC, <span class="at">y =</span> Count, <span class="at">fill =</span> PERP_RACE)) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Offense Description"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Perpetrator Race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>nypd_payroll <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"dataset/nypd_payroll.rds"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>nypd_payroll <span class="ot">&lt;-</span> nypd_payroll <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">work_boro =</span> <span class="st">`</span><span class="at">Work Location Borough</span><span class="st">`</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_salary =</span> <span class="st">`</span><span class="at">Base Salary</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>average_salary_by_borough <span class="ot">&lt;-</span> nypd_payroll <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(work_boro) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AverageSalary =</span> <span class="fu">mean</span>(base_salary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Ensure that we remove the grouping structure</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Now plot the average salary by borough using ggplot2</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(average_salary_by_borough, <span class="fu">aes</span>(<span class="at">x =</span> work_boro, <span class="at">y =</span> AverageSalary, <span class="at">fill =</span> work_boro)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Salary by Work Location Borough"</span>, <span class="at">x =</span> <span class="st">"Work Location Borough"</span>, <span class="at">y =</span> <span class="st">"Average Salary"</span>) <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average salary by borough</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>average_salary_by_borough <span class="ot">&lt;-</span> nypd_payroll <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(work_boro) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AverageSalary =</span> <span class="fu">mean</span>(base_salary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>borough_to_fips <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">work_boro =</span> <span class="fu">c</span>(<span class="st">"BRONX"</span>, <span class="st">"BROOKLYN"</span>, <span class="st">"MANHATTAN"</span>, <span class="st">"QUEENS"</span>, <span class="st">"OTHER"</span>),  <span class="co"># Note: Ensure the names match the data</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">COUNTYFP =</span> <span class="fu">c</span>(<span class="st">"005"</span>, <span class="st">"047"</span>, <span class="st">"061"</span>, <span class="st">"081"</span>, <span class="st">"085"</span>))</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>average_salary_by_fips <span class="ot">&lt;-</span> average_salary_by_borough <span class="sc">%&gt;%</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(borough_to_fips, <span class="at">by =</span> <span class="st">"work_boro"</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>average_salary_by_fips <span class="ot">&lt;-</span> average_salary_by_fips <span class="sc">%&gt;%</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(COUNTYFP, AverageSalary)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(average_salary_by_fips)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  COUNTYFP AverageSalary
  &lt;chr&gt;            &lt;dbl&gt;
1 005             50428.
2 047             36477.
3 061            100433.
4 085            115659.
5 081             40035.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map Average Salary by NYC Borough</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>nyc_tracts_salary <span class="ot">&lt;-</span> nyc_tracts <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(average_salary_by_fips, <span class="at">by =</span> <span class="st">"COUNTYFP"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the map with average salaries indicated by color</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nyc_tracts_salary) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> AverageSalary), <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"deepskyblue4"</span>, <span class="at">name =</span> <span class="st">"Avg Salary"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.value =</span> <span class="st">"grey50"</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Salary by NYC Borough"</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Color intensity indicates average salary levels"</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Average Salary"</span>) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average Salary and Crime Data Points by NYC Borough</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>map_df <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(map_df, <span class="fu">st_crs</span>(nyc_tracts_salary)<span class="sc">$</span>epsg)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>final_combined_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> nyc_tracts_salary, <span class="fu">aes</span>(<span class="at">fill =</span> AverageSalary), <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> map_df, <span class="fu">aes</span>(<span class="at">color =</span> VIC_RACE), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"deepskyblue4"</span>, <span class="at">name =</span> <span class="st">"Avg Salary"</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.value =</span> <span class="st">"grey50"</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ASIAN / PACIFIC ISLANDER"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"BLACK"</span> <span class="ot">=</span> <span class="st">"brown3"</span>, <span class="st">"WHITE HISPANIC"</span> <span class="ot">=</span> <span class="st">"yellow"</span>, <span class="st">"WHITE"</span> <span class="ot">=</span> <span class="st">"deeppink"</span>, <span class="st">"UNKNOWN"</span> <span class="ot">=</span> <span class="st">"darkgray"</span>, <span class="st">"BLACK HISPANIC"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>), <span class="at">name =</span> <span class="st">"Victim's Race"</span>) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Salary and Crime Data Points by NYC Borough"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Boroughs colored by average salary; Points indicate crime locations"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Average Salary"</span>, <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">color =</span> <span class="st">"Victim's Race"</span>) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(final_combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>map_df <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(map_df, <span class="fu">st_crs</span>(nyc_tracts_salary)<span class="sc">$</span>epsg)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>final_combined_plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> nyc_tracts_salary, <span class="fu">aes</span>(<span class="at">fill =</span> AverageSalary), <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> map_df, <span class="fu">aes</span>(<span class="at">color =</span> PERP_RACE), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"deepskyblue4"</span>, <span class="at">name =</span> <span class="st">"Avg Salary"</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.value =</span> <span class="st">"grey50"</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ASIAN / PACIFIC ISLANDER"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"BLACK"</span> <span class="ot">=</span> <span class="st">"brown3"</span>, <span class="st">"WHITE HISPANIC"</span> <span class="ot">=</span> <span class="st">"yellow"</span>, <span class="st">"WHITE"</span> <span class="ot">=</span> <span class="st">"deeppink"</span>, <span class="st">"UNKNOWN"</span> <span class="ot">=</span> <span class="st">"darkgray"</span>, <span class="st">"BLACK HISPANIC"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>), <span class="at">name =</span> <span class="st">"Perpetrator's Race"</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Salary and Crime Data Points by NYC Borough"</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Boroughs colored by average salary; Points indicate crime locations"</span>,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Average Salary"</span>, <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">color =</span> <span class="st">"Perpetrator's Race"</span>) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(final_combined_plot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>vic_race <span class="ot">&lt;-</span> combined_df <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(VIC_RACE) <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vic_race, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(VIC_RACE, n), <span class="at">y =</span> n, <span class="at">fill =</span> VIC_RACE)) <span class="sc">+</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Victim Race Distribution"</span>, <span class="at">x =</span> <span class="st">"Victim Race"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>modeldata <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.factor))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">table</span>(modeldata<span class="sc">$</span>OFNS_DESC)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>modeldata <span class="ot">&lt;-</span> modeldata[modeldata<span class="sc">$</span>OFNS_DESC <span class="sc">%in%</span> <span class="fu">names</span>(freq[freq <span class="sc">&gt;=</span> <span class="dv">200</span>]), ]</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(modeldata), <span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(modeldata))  <span class="co"># 80% for training</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> modeldata[train_indices, ]</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> modeldata[<span class="sc">-</span>train_indices, ]</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(BORO <span class="sc">~</span> PERP_SEX <span class="sc">+</span> PERP_RACE <span class="sc">+</span> LOC_CLASSFCTN_DESC <span class="sc">+</span> PERP_AGE_GROUP <span class="sc">+</span> VIC_SEX <span class="sc">+</span> VIC_AGE_GROUP <span class="sc">+</span> VIC_RACE <span class="sc">+</span> OFNS_DESC <span class="sc">+</span> STATISTICAL_MURDER_FLAG, </span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> train_data, </span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.action =</span> na.omit)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, test_data)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>conf_mat <span class="ot">&lt;-</span> <span class="fu">table</span>(test_data<span class="sc">$</span>BORO, test_pred)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(conf_mat)) <span class="sc">/</span> <span class="fu">sum</span>(conf_mat)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy:"</span>, accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy: 0.839729119638826"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           BRONX  BROOKLYN MANHATTAN   QUEENS STATEN ISLAND
PERP_SEX                12.69318  9.458377  5.221241 16.35497      -1.33696
PERP_RACE               50.62434 70.470422 53.080604 39.21863      32.21420
LOC_CLASSFCTN_DESC      72.91659 67.026035 63.682934 45.41541      32.74132
PERP_AGE_GROUP          63.38661 67.086130 65.958136 49.27119      36.09068
VIC_SEX                 35.63953 32.607221 36.428757 18.75103      19.36226
VIC_AGE_GROUP           53.10915 61.768631 76.562749 48.94069      30.56484
VIC_RACE                52.47619 63.871629 58.334073 54.85735      24.35468
OFNS_DESC               69.32860 89.785256 68.497566 62.34784      29.72071
STATISTICAL_MURDER_FLAG 29.06915 31.629669 56.325519 22.57633      20.41800
                        MeanDecreaseAccuracy MeanDecreaseGini
PERP_SEX                            18.76525         6.746145
PERP_RACE                           81.56647        79.962885
LOC_CLASSFCTN_DESC                  95.26111       150.759675
PERP_AGE_GROUP                      99.03290       122.623032
VIC_SEX                             49.50069        41.896652
VIC_AGE_GROUP                       99.71094       136.192321
VIC_RACE                            85.09536       141.208794
OFNS_DESC                          123.01682       182.182583
STATISTICAL_MURDER_FLAG             57.42919        44.251227</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>BORO <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>BORO)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>LOC_CLASSFCTN_DESC <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>LOC_CLASSFCTN_DESC)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>PERP_AGE_GROUP <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>PERP_AGE_GROUP)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>VIC_AGE_GROUP <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>VIC_AGE_GROUP)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>VIC_RACE <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>VIC_RACE)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>OFNS_DESC <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>OFNS_DESC)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">multinom</span>(BORO <span class="sc">~</span> LOC_CLASSFCTN_DESC <span class="sc">+</span> PERP_AGE_GROUP <span class="sc">+</span> VIC_AGE_GROUP <span class="sc">+</span> </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>                    VIC_RACE <span class="sc">+</span> OFNS_DESC, <span class="at">data =</span> combined_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  320 (252 variable)
initial  value 5909.856014 
iter  10 value 4481.873149
iter  20 value 4098.349411
iter  30 value 3862.622898
iter  40 value 3815.275185
iter  50 value 3803.097032
iter  60 value 3794.484527
iter  70 value 3791.953534
iter  80 value 3791.144229
iter  90 value 3789.976831
iter 100 value 3789.240580
final  value 3789.240580 
stopped after 100 iterations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = BORO ~ LOC_CLASSFCTN_DESC + PERP_AGE_GROUP + 
    VIC_AGE_GROUP + VIC_RACE + OFNS_DESC, data = combined_df)

Coefficients:
               (Intercept) LOC_CLASSFCTN_DESCDWELLING LOC_CLASSFCTN_DESCHOUSING
BROOKLYN        5.38309657                  0.1718707                  3.295637
MANHATTAN       0.46403462                 -2.1523707                  2.180908
QUEENS          0.01138576                 -1.3614395                  2.359438
STATEN ISLAND -13.34881277                  1.9154980                 -1.363051
              LOC_CLASSFCTN_DESCOTHER LOC_CLASSFCTN_DESCPARKING LOT
BROOKLYN                   -10.914521                     10.010840
MANHATTAN                   -1.143160                     12.655627
QUEENS                     -11.472180                     11.966612
STATEN ISLAND               -8.390643                      4.151562
              LOC_CLASSFCTN_DESCPLAYGROUND LOC_CLASSFCTN_DESCSTREET
BROOKLYN                          0.349577                0.1641429
MANHATTAN                        -9.845198               -0.8751595
QUEENS                           -1.093975               -0.4069299
STATEN ISLAND                    -5.444282                0.4083409
              LOC_CLASSFCTN_DESCTRANSIT LOC_CLASSFCTN_DESCVEHICLE
BROOKLYN                       2.587202                -13.566446
MANHATTAN                     -2.669428                -15.193567
QUEENS                         2.851006                 -4.027211
STATEN ISLAND                 -2.069582                -11.946448
              PERP_AGE_GROUP18-24 PERP_AGE_GROUP25-44 PERP_AGE_GROUP45-64
BROOKLYN               -0.8569572          -0.2041359          0.98260276
MANHATTAN              -1.6842132          -1.2386525         -0.03904947
QUEENS                 -1.8826932          -0.9375756         -0.76083764
STATEN ISLAND          -2.3567747          -4.4366553          0.04666818
              PERP_AGE_GROUP65+ VIC_AGE_GROUP18-24 VIC_AGE_GROUP25-44
BROOKLYN              -8.873213         0.04889143         -0.4648887
MANHATTAN             -9.423610         1.68799027          1.5641813
QUEENS                -8.607682         1.03575833          0.5480964
STATEN ISLAND         -1.154381         7.60273788          8.1260337
              VIC_AGE_GROUP45-64 VIC_AGE_GROUP65+ VIC_AGE_GROUPUNKNOWN
BROOKLYN              -1.3435642       -0.6298162           3.97523253
MANHATTAN              1.6719071       -8.4860889          -0.81143390
QUEENS                -0.1800559       -8.8553482          -0.63612574
STATEN ISLAND          6.3432393       -0.1839871           0.08988613
              VIC_RACEBLACK VIC_RACEBLACK HISPANIC VIC_RACEUNKNOWN
BROOKLYN         -1.3814241              -2.461144      3.97523253
MANHATTAN        -0.1546642              -1.505405     -0.81143390
QUEENS           -1.5842094              -1.070678     -0.63612574
STATEN ISLAND     3.9360143              -2.746036      0.08988613
              VIC_RACEWHITE VIC_RACEWHITE HISPANIC
BROOKLYN          -3.129484              -2.918213
MANHATTAN         -0.626568              -1.650751
QUEENS            -5.236546              -3.357969
STATEN ISLAND      1.531347              -3.258405
              OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW
BROOKLYN                                    6.2497664
MANHATTAN                                  -2.0679762
QUEENS                                     -0.8608307
STATEN ISLAND                              -0.5468655
              OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES OFNS_DESCBURGLAR'S TOOLS
BROOKLYN                                 -3.3930757                 4.470462
MANHATTAN                                 0.2465254                 7.708313
QUEENS                                    1.4737148                -1.020152
STATEN ISLAND                             0.2296628                -1.798457
              OFNS_DESCBURGLARY OFNS_DESCCANNABIS RELATED OFFENSES
BROOKLYN             -2.7101618                         -4.4792412
MANHATTAN             1.8696887                          7.2252667
QUEENS                0.9655227                          9.6540442
STATEN ISLAND         2.2656605                         -0.3396187
              OFNS_DESCCHILD ABANDONMENT/NON SUPPORT
BROOKLYN                                  -10.104494
MANHATTAN                                  -7.609409
QUEENS                                     -4.269084
STATEN ISLAND                              -4.662274
              OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF
BROOKLYN                                -3.4344480982
MANHATTAN                               -0.0004441068
QUEENS                                   1.2919340576
STATEN ISLAND                            0.4169907935
              OFNS_DESCCRIMINAL TRESPASS OFNS_DESCDANGEROUS DRUGS
BROOKLYN                       -3.449561                -2.809717
MANHATTAN                       0.207329                 1.424708
QUEENS                          1.858272                 1.216431
STATEN ISLAND                  -5.465592                 1.985349
              OFNS_DESCDANGEROUS WEAPONS OFNS_DESCFELONY ASSAULT
BROOKLYN                      -2.3764874             -3.52965082
MANHATTAN                      0.7904269              0.08852122
QUEENS                         2.3825572              1.79355032
STATEN ISLAND                  1.6730465              0.94812246
              OFNS_DESCFOR OTHER AUTHORITIES OFNS_DESCFORGERY OFNS_DESCFRAUDS
BROOKLYN                           -4.331489        -1.886508       -3.802961
MANHATTAN                          -0.419131         2.058801       -3.348098
QUEENS                             -8.217205         2.771782       -7.249211
STATEN ISLAND                      -6.069437        -4.030094        3.846216
              OFNS_DESCGAMBLING OFNS_DESCGRAND LARCENY
BROOKLYN              -2.592840              -1.694616
MANHATTAN             -1.489660               1.322054
QUEENS                -7.332114               1.483683
STATEN ISLAND         -3.732154               3.804702
              OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE OFNS_DESCHARRASSMENT 2
BROOKLYN                                    -4.275515            -1.47144021
MANHATTAN                                   -8.570816             2.08791486
QUEENS                                      -7.996689            -0.45007574
STATEN ISLAND                                2.043654             0.03881866
              OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE
BROOKLYN                                  -1.47144021
MANHATTAN                                  2.08791486
QUEENS                                    -0.45007574
STATEN ISLAND                              0.03881866
              OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING
BROOKLYN                                  -3.20899749
MANHATTAN                                  0.07996328
QUEENS                                     2.41339013
STATEN ISLAND                             -3.85480606
              OFNS_DESCINTOXICATED/IMPAIRED DRIVING
BROOKLYN                                 6.52646039
MANHATTAN                               -1.85254272
QUEENS                                  -0.83287035
STATEN ISLAND                           -0.05512181
              OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES
BROOKLYN                                  5.33502471
MANHATTAN                                -2.05983054
QUEENS                                   -1.94794177
STATEN ISLAND                             0.02228665
              OFNS_DESCMISCELLANEOUS PENAL LAW
BROOKLYN                            -2.9334670
MANHATTAN                            0.9208626
QUEENS                               2.4178580
STATEN ISLAND                        2.2860207
              OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE
BROOKLYN                                   -4.7207310
MANHATTAN                                  -0.5599218
QUEENS                                      2.6057101
STATEN ISLAND                              -6.0780024
              OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY
BROOKLYN                                  -3.155985
MANHATTAN                                 -8.425087
QUEENS                                     2.396077
STATEN ISLAND                             -5.098838
              OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;
BROOKLYN                                  -4.0611399
MANHATTAN                                 -0.1091252
QUEENS                                     0.3820032
STATEN ISLAND                             -5.1624376
              OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI
BROOKLYN                                   -3.3294383
MANHATTAN                                   0.4393437
QUEENS                                      0.6021190
STATEN ISLAND                               1.9309745
              OFNS_DESCOFFENSES AGAINST THE PERSON
BROOKLYN                                -3.8466893
MANHATTAN                               -0.8413625
QUEENS                                  -7.6186545
STATEN ISLAND                            2.4417923
              OFNS_DESCOFFENSES INVOLVING FRAUD
BROOKLYN                              -3.265997
MANHATTAN                              1.661809
QUEENS                                -7.536230
STATEN ISLAND                          2.729618
              OFNS_DESCOTHER OFFENSES RELATED TO THEF OFNS_DESCOTHER STATE LAWS
BROOKLYN                                    5.5895870                7.00720451
MANHATTAN                                  10.3162699               11.75541031
QUEENS                                     12.3175929               -1.73158188
STATEN ISLAND                               0.4380312                0.07436408
              OFNS_DESCOTHER STATE LAWS (NON PENAL LA
BROOKLYN                                  -3.15127671
MANHATTAN                                  9.20768165
QUEENS                                    -0.94169404
STATEN ISLAND                             -0.04765943
              OFNS_DESCOTHER TRAFFIC INFRACTION OFNS_DESCPETIT LARCENY
BROOKLYN                              -3.149292             -2.7554024
MANHATTAN                             -8.002306              0.8995785
QUEENS                                 2.306239              1.0580068
STATEN ISLAND                          2.837280             -3.7350105
              OFNS_DESCPOSSESSION OF STOLEN PROPERTY OFNS_DESCRAPE
BROOKLYN                                  -3.9196141   -2.17836862
MANHATTAN                                 -1.4079867    0.04404928
QUEENS                                     0.9768533    1.89302248
STATEN ISLAND                              2.4645774    2.32728333
              OFNS_DESCROBBERY OFNS_DESCSEX CRIMES
BROOKLYN            -3.0663303           -2.441760
MANHATTAN            1.0738103            0.879036
QUEENS               1.6343687            2.637418
STATEN ISLAND        0.9020777            3.149106
              OFNS_DESCUNAUTHORIZED USE OF A VEHICLE
BROOKLYN                                   -4.694043
MANHATTAN                                  -3.512008
QUEENS                                      0.860939
STATEN ISLAND                              -3.941346
              OFNS_DESCVEHICLE AND TRAFFIC LAWS
BROOKLYN                             -2.7730431
MANHATTAN                             0.5946681
QUEENS                                3.4310808
STATEN ISLAND                         2.3499057

Std. Errors:
              (Intercept) LOC_CLASSFCTN_DESCDWELLING LOC_CLASSFCTN_DESCHOUSING
BROOKLYN         3.823165                  0.2812438                 0.3853658
MANHATTAN        8.896781                  0.3271728                 0.3725429
QUEENS          22.601222                  0.4357313                 0.4450423
STATEN ISLAND    9.879301                  0.8536040                 3.4180563
              LOC_CLASSFCTN_DESCOTHER LOC_CLASSFCTN_DESCPARKING LOT
BROOKLYN                   31.2701773                      66.76240
MANHATTAN                   0.3436321                      66.75655
QUEENS                     50.1932864                      66.76115
STATEN ISLAND              38.9892990                      68.22678
              LOC_CLASSFCTN_DESCPLAYGROUND LOC_CLASSFCTN_DESCSTREET
BROOKLYN                          0.628701                0.2278195
MANHATTAN                        46.306222                0.2081963
QUEENS                            1.185986                0.2876671
STATEN ISLAND                    38.976756                0.7749946
              LOC_CLASSFCTN_DESCTRANSIT LOC_CLASSFCTN_DESCVEHICLE
BROOKLYN                       1.218343                33.4156788
MANHATTAN                      1.688946                71.4082859
QUEENS                         1.326813                 0.7803245
STATEN ISLAND                  9.283981                30.2373652
              PERP_AGE_GROUP18-24 PERP_AGE_GROUP25-44 PERP_AGE_GROUP45-64
BROOKLYN                0.2033747           0.2138638           0.3273612
MANHATTAN               0.2084141           0.2154003           0.3372590
QUEENS                  0.2408102           0.2493313           0.4452929
STATEN ISLAND           0.3270553           0.6105946           0.5344809
              PERP_AGE_GROUP65+ VIC_AGE_GROUP18-24 VIC_AGE_GROUP25-44
BROOKLYN               56.87460          0.1517981          0.1600797
MANHATTAN              43.04724          0.2238148          0.2269404
QUEENS                 56.45754          0.2378393          0.2459359
STATEN ISLAND          21.45444          6.4744708          6.4747019
              VIC_AGE_GROUP45-64 VIC_AGE_GROUP65+ VIC_AGE_GROUPUNKNOWN
BROOKLYN               0.2306999        0.4763101         3.451548e+01
MANHATTAN              0.2631408       35.4310960         5.502518e+00
QUEENS                 0.3450412       47.3031713         7.996824e+01
STATEN ISLAND          6.4856317       45.6752495         2.489843e-05
              VIC_RACEBLACK VIC_RACEBLACK HISPANIC VIC_RACEUNKNOWN
BROOKLYN          0.5764637              0.6004869    3.451548e+01
MANHATTAN         0.6462267              0.6725965    5.502518e+00
QUEENS            0.6277580              0.6452815    7.996824e+01
STATEN ISLAND     6.2957449              9.7199912    2.489843e-05
              VIC_RACEWHITE VIC_RACEWHITE HISPANIC
BROOKLYN          0.7656591              0.5862328
MANHATTAN         0.7577864              0.6569682
QUEENS            1.0439471              0.6527688
STATEN ISLAND     6.9755605              7.3125098
              OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW
BROOKLYN                                   127.687515
MANHATTAN                                   19.536311
QUEENS                                       7.024816
STATEN ISLAND                                3.637502
              OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES OFNS_DESCBURGLAR'S TOOLS
BROOKLYN                                   3.771474                50.373106
MANHATTAN                                  8.869233                51.004682
QUEENS                                    22.590349                 4.185696
STATEN ISLAND                              4.590844                 1.248588
              OFNS_DESCBURGLARY OFNS_DESCCANNABIS RELATED OFFENSES
BROOKLYN               3.787897                          75.773712
MANHATTAN              8.874557                          38.708711
QUEENS                22.602354                          43.929025
STATEN ISLAND          4.685150                           0.932806
              OFNS_DESCCHILD ABANDONMENT/NON SUPPORT
BROOKLYN                                    37.95841
MANHATTAN                                   63.96659
QUEENS                                      49.80019
STATEN ISLAND                               50.42928
              OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF
BROOKLYN                                     3.776107
MANHATTAN                                    8.871582
QUEENS                                      22.592007
STATEN ISLAND                                4.671975
              OFNS_DESCCRIMINAL TRESPASS OFNS_DESCDANGEROUS DRUGS
BROOKLYN                        3.826792                 3.772347
MANHATTAN                       8.891409                 8.869215
QUEENS                         22.602093                22.591209
STATEN ISLAND                  40.875094                 4.580792
              OFNS_DESCDANGEROUS WEAPONS OFNS_DESCFELONY ASSAULT
BROOKLYN                        3.777018                3.773309
MANHATTAN                       8.872127                8.870079
QUEENS                         22.591612               22.590632
STATEN ISLAND                   4.606509                4.584973
              OFNS_DESCFOR OTHER AUTHORITIES OFNS_DESCFORGERY OFNS_DESCFRAUDS
BROOKLYN                            3.818194         3.854473        3.870786
MANHATTAN                           8.884248         8.904094        9.124417
QUEENS                             62.517493        22.612772       63.056490
STATEN ISLAND                      49.411660        33.079670        4.737744
              OFNS_DESCGAMBLING OFNS_DESCGRAND LARCENY
BROOKLYN               3.879275               3.785448
MANHATTAN              8.966480               8.877254
QUEENS                68.089405              22.602934
STATEN ISLAND         39.327422               4.613171
              OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE OFNS_DESCHARRASSMENT 2
BROOKLYN                                     3.853665            27.43474347
MANHATTAN                                   36.032256            26.78962133
QUEENS                                      70.060617            51.92543749
STATEN ISLAND                                4.674504             0.06291444
              OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE
BROOKLYN                                  27.43474347
MANHATTAN                                 26.78962134
QUEENS                                    51.92543749
STATEN ISLAND                              0.06291444
              OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING
BROOKLYN                                     3.835086
MANHATTAN                                    8.908448
QUEENS                                      22.605551
STATEN ISLAND                               39.294526
              OFNS_DESCINTOXICATED/IMPAIRED DRIVING
BROOKLYN                                137.0021169
MANHATTAN                                15.9298206
QUEENS                                    4.9231659
STATEN ISLAND                             0.5404113
              OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES
BROOKLYN                                1.261155e+02
MANHATTAN                               3.564659e+01
QUEENS                                  1.196784e+01
STATEN ISLAND                           6.749640e-04
              OFNS_DESCMISCELLANEOUS PENAL LAW
BROOKLYN                              3.773880
MANHATTAN                             8.870171
QUEENS                               22.590689
STATEN ISLAND                         4.588219
              OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE
BROOKLYN                                     3.908566
MANHATTAN                                    8.914976
QUEENS                                      22.605899
STATEN ISLAND                               46.134791
              OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY
BROOKLYN                                   3.855648
MANHATTAN                                 43.211854
QUEENS                                    22.607014
STATEN ISLAND                             51.183037
              OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;
BROOKLYN                                    3.809241
MANHATTAN                                   8.883665
QUEENS                                     22.604996
STATEN ISLAND                              36.096183
              OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI
BROOKLYN                                     3.777585
MANHATTAN                                    8.872059
QUEENS                                      22.594873
STATEN ISLAND                                4.594418
              OFNS_DESCOFFENSES AGAINST THE PERSON
BROOKLYN                                  3.819607
MANHATTAN                                 8.906848
QUEENS                                   61.643976
STATEN ISLAND                             4.651208
              OFNS_DESCOFFENSES INVOLVING FRAUD
BROOKLYN                               3.796663
MANHATTAN                              8.875805
QUEENS                                56.200447
STATEN ISLAND                          4.609548
              OFNS_DESCOTHER OFFENSES RELATED TO THEF OFNS_DESCOTHER STATE LAWS
BROOKLYN                                   48.2249143              78.441147473
MANHATTAN                                  48.8935631              78.854196485
QUEENS                                     53.1176497               1.643681636
STATEN ISLAND                               0.3737237               0.002794832
              OFNS_DESCOTHER STATE LAWS (NON PENAL LA
BROOKLYN                                   80.8045390
MANHATTAN                                  61.8503432
QUEENS                                      6.6957945
STATEN ISLAND                               0.6073257
              OFNS_DESCOTHER TRAFFIC INFRACTION OFNS_DESCPETIT LARCENY
BROOKLYN                               3.808921               3.771874
MANHATTAN                             31.327689               8.869694
QUEENS                                22.598605              22.592472
STATEN ISLAND                          4.645843               8.593164
              OFNS_DESCPOSSESSION OF STOLEN PROPERTY OFNS_DESCRAPE
BROOKLYN                                    3.806913      3.776228
MANHATTAN                                   8.900884      8.876068
QUEENS                                     22.603148     22.593480
STATEN ISLAND                               4.652236      4.600900
              OFNS_DESCROBBERY OFNS_DESCSEX CRIMES
BROOKLYN              3.780023            3.770136
MANHATTAN             8.871934            8.868785
QUEENS               22.593134           22.589801
STATEN ISLAND         4.673316            4.572057
              OFNS_DESCUNAUTHORIZED USE OF A VEHICLE
BROOKLYN                                    3.892620
MANHATTAN                                   9.208759
QUEENS                                     22.619077
STATEN ISLAND                              43.376362
              OFNS_DESCVEHICLE AND TRAFFIC LAWS
BROOKLYN                               3.777711
MANHATTAN                              8.872558
QUEENS                                22.590815
STATEN ISLAND                          4.589657

Residual Deviance: 7578.481 
AIC: 8074.481 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> combined_df)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> combined_df, <span class="at">type =</span> <span class="st">"probs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>BORO <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>BORO)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>LOC_CLASSFCTN_DESC <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>LOC_CLASSFCTN_DESC)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>PERP_AGE_GROUP <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>PERP_AGE_GROUP)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>VIC_AGE_GROUP <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>VIC_AGE_GROUP)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>VIC_RACE <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>VIC_RACE)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>OFNS_DESC <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>OFNS_DESC)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">multinom</span>(BORO <span class="sc">~</span> LOC_CLASSFCTN_DESC <span class="sc">+</span> PERP_RACE <span class="sc">+</span> PERP_AGE_GROUP <span class="sc">+</span> VIC_AGE_GROUP <span class="sc">+</span> </span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>                    VIC_RACE <span class="sc">+</span> OFNS_DESC, <span class="at">data =</span> combined_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  340 (268 variable)
initial  value 5909.856014 
iter  10 value 4346.177699
iter  20 value 3985.365782
iter  30 value 3766.005650
iter  40 value 3697.523673
iter  50 value 3672.737513
iter  60 value 3656.389152
iter  70 value 3650.721596
iter  80 value 3648.619727
iter  90 value 3647.553311
iter 100 value 3646.883265
final  value 3646.883265 
stopped after 100 iterations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = BORO ~ LOC_CLASSFCTN_DESC + PERP_RACE + PERP_AGE_GROUP + 
    VIC_AGE_GROUP + VIC_RACE + OFNS_DESC, data = combined_df)

Coefficients:
              (Intercept) LOC_CLASSFCTN_DESCDWELLING LOC_CLASSFCTN_DESCHOUSING
BROOKLYN        -2.373918                  0.1221416                  3.012517
MANHATTAN       -5.166003                 -2.2408176                  1.888519
QUEENS          15.302853                 -1.6785343                  1.964891
STATEN ISLAND  -13.374809                  1.7407029                 -8.091718
              LOC_CLASSFCTN_DESCOTHER LOC_CLASSFCTN_DESCPARKING LOT
BROOKLYN                   -17.380383                     12.606658
MANHATTAN                   -1.390217                     15.077706
QUEENS                     -13.390927                     14.396440
STATEN ISLAND               -9.819640                      5.974809
              LOC_CLASSFCTN_DESCPLAYGROUND LOC_CLASSFCTN_DESCSTREET
BROOKLYN                       -0.07064734               0.09804304
MANHATTAN                     -15.01557591              -0.96167149
QUEENS                         -1.58376597              -0.69435812
STATEN ISLAND                  -7.54638821               0.06403714
              LOC_CLASSFCTN_DESCTRANSIT LOC_CLASSFCTN_DESCVEHICLE
BROOKLYN                       2.065785                -20.411063
MANHATTAN                     -2.941965                -20.130867
QUEENS                         3.136824                 -3.635781
STATEN ISLAND                 -1.765486                -14.336368
              PERP_RACEBLACK PERP_RACEBLACK HISPANIC PERP_RACEWHITE
BROOKLYN            7.257759                2.576457      0.5269339
MANHATTAN           5.566472                4.137775     -1.9974501
QUEENS            -16.814595              -19.552619    -10.3496025
STATEN ISLAND      -2.361860               -8.048572     19.1105182
              PERP_RACEWHITE HISPANIC PERP_AGE_GROUP18-24 PERP_AGE_GROUP25-44
BROOKLYN                     6.172678          -0.8352539          -0.1182323
MANHATTAN                    4.734586          -1.6948341          -1.2072681
QUEENS                     -16.388660          -2.1166145          -1.2173662
STATEN ISLAND               -8.362695          -2.4655966          -4.3411867
              PERP_AGE_GROUP45-64 PERP_AGE_GROUP65+ VIC_AGE_GROUP18-24
BROOKLYN               0.94499542         -13.35905          0.2943241
MANHATTAN             -0.07371546         -16.27690          1.8817583
QUEENS                -1.60772732         -12.56288          1.2253106
STATEN ISLAND         -0.08329483          -7.16342          9.5105098
              VIC_AGE_GROUP25-44 VIC_AGE_GROUP45-64 VIC_AGE_GROUP65+
BROOKLYN              -0.3752018         -1.0853066       -0.5884557
MANHATTAN              1.6577723          1.9084363      -13.4846472
QUEENS                 0.6981710          0.1812106      -10.3703336
STATEN ISLAND          9.5148597          8.0086777       -0.3196128
              VIC_AGE_GROUPUNKNOWN VIC_RACEBLACK VIC_RACEBLACK HISPANIC
BROOKLYN                  4.377609    -1.0858192             -1.7044946
MANHATTAN                -1.249051     0.1267509             -0.8912605
QUEENS                   -1.082861    -0.4398343              0.1653753
STATEN ISLAND             3.303089     5.4044408             -2.6109862
              VIC_RACEUNKNOWN VIC_RACEWHITE VIC_RACEWHITE HISPANIC
BROOKLYN             4.377609   -2.41276458             -1.9884726
MANHATTAN           -1.249051   -0.00460398             -0.8660246
QUEENS              -1.082861   -4.02871885             -2.1737595
STATEN ISLAND        3.303089   -3.29667776             -2.5700047
              OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW
BROOKLYN                                    8.2336958
MANHATTAN                                  -3.6529684
QUEENS                                     -1.0848431
STATEN ISLAND                              -0.4307234
              OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES OFNS_DESCBURGLAR'S TOOLS
BROOKLYN                                 -3.1630252                 5.204052
MANHATTAN                                 0.0879050                 8.062815
QUEENS                                    2.1978875                -1.218981
STATEN ISLAND                             0.1087353                -2.260365
              OFNS_DESCBURGLARY OFNS_DESCCANNABIS RELATED OFFENSES
BROOKLYN              -2.605770                         -6.9238697
MANHATTAN              1.633311                          8.2703326
QUEENS                 1.713103                         11.6460965
STATEN ISLAND          1.972926                         -0.9573584
              OFNS_DESCCHILD ABANDONMENT/NON SUPPORT
BROOKLYN                                  -10.381361
MANHATTAN                                  -7.967030
QUEENS                                     -3.058734
STATEN ISLAND                              -4.530470
              OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF
BROOKLYN                                   -3.1046075
MANHATTAN                                  -0.0922304
QUEENS                                      2.0517055
STATEN ISLAND                               0.3199100
              OFNS_DESCCRIMINAL TRESPASS OFNS_DESCDANGEROUS DRUGS
BROOKLYN                     -3.31505274                -2.639850
MANHATTAN                    -0.03627709                 1.229356
QUEENS                        2.41913325                 1.535873
STATEN ISLAND                -4.85964831                 1.742550
              OFNS_DESCDANGEROUS WEAPONS OFNS_DESCFELONY ASSAULT
BROOKLYN                      -2.2815398             -3.29025472
MANHATTAN                      0.5398624             -0.05922242
QUEENS                         3.0131076              2.55716200
STATEN ISLAND                  1.4081399              0.78409551
              OFNS_DESCFOR OTHER AUTHORITIES OFNS_DESCFORGERY OFNS_DESCFRAUDS
BROOKLYN                           -3.746351        -1.705361       -3.721927
MANHATTAN                          -0.321545         1.823530       -3.152096
QUEENS                             -9.112956         2.724973       -9.009103
STATEN ISLAND                      -5.790101        -4.628855        3.419626
              OFNS_DESCGAMBLING OFNS_DESCGRAND LARCENY
BROOKLYN              -2.508884              -1.337965
MANHATTAN             -1.761691               1.251408
QUEENS                -8.637388               2.275195
STATEN ISLAND         -5.918874               3.372359
              OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE OFNS_DESCHARRASSMENT 2
BROOKLYN                                    -3.513100            -1.21501172
MANHATTAN                                  -12.811909             1.71785221
QUEENS                                      -7.665202             0.04428426
STATEN ISLAND                                2.313070            -0.21056524
              OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE
BROOKLYN                                  -1.21501172
MANHATTAN                                  1.71785221
QUEENS                                     0.04428426
STATEN ISLAND                             -0.21056524
              OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING
BROOKLYN                                   -2.5520516
MANHATTAN                                   0.2201628
QUEENS                                      2.9579383
STATEN ISLAND                               0.2310322
              OFNS_DESCINTOXICATED/IMPAIRED DRIVING
BROOKLYN                                  8.3841198
MANHATTAN                                -3.0745798
QUEENS                                   -1.0191140
STATEN ISLAND                            -0.1100694
              OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES
BROOKLYN                                  6.67016039
MANHATTAN                                -2.99096065
QUEENS                                   -2.45511266
STATEN ISLAND                             0.06634855
              OFNS_DESCMISCELLANEOUS PENAL LAW
BROOKLYN                             -2.759093
MANHATTAN                             0.744649
QUEENS                                3.163586
STATEN ISLAND                         2.231243
              OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE
BROOKLYN                                   -4.3328833
MANHATTAN                                  -0.4239123
QUEENS                                      3.7490261
STATEN ISLAND                              -7.1542534
              OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY
BROOKLYN                                  -2.892620
MANHATTAN                                -11.401162
QUEENS                                     3.240193
STATEN ISLAND                             -5.979946
              OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;
BROOKLYN                                  -3.9793037
MANHATTAN                                 -0.3314121
QUEENS                                     1.1020024
STATEN ISLAND                             -4.8840801
              OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI
BROOKLYN                                    -3.161254
MANHATTAN                                    0.241304
QUEENS                                       1.156733
STATEN ISLAND                                1.724242
              OFNS_DESCOFFENSES AGAINST THE PERSON
BROOKLYN                                -3.3022501
MANHATTAN                               -0.6489853
QUEENS                                  -8.7896812
STATEN ISLAND                            2.8591081
              OFNS_DESCOFFENSES INVOLVING FRAUD
BROOKLYN                              -2.686364
MANHATTAN                              1.776641
QUEENS                                -6.431878
STATEN ISLAND                          2.498034
              OFNS_DESCOTHER OFFENSES RELATED TO THEF OFNS_DESCOTHER STATE LAWS
BROOKLYN                                     7.807339                  9.360799
MANHATTAN                                   11.892542                 13.832912
QUEENS                                      14.556856                 -3.004911
STATEN ISLAND                                5.989067                  1.044460
              OFNS_DESCOTHER STATE LAWS (NON PENAL LA
BROOKLYN                                   -5.1108509
MANHATTAN                                  12.1571537
QUEENS                                     -1.3887966
STATEN ISLAND                               0.1408587
              OFNS_DESCOTHER TRAFFIC INFRACTION OFNS_DESCPETIT LARCENY
BROOKLYN                              -2.950695             -2.7523521
MANHATTAN                            -12.430420              0.5926297
QUEENS                                 2.887470              1.5648049
STATEN ISLAND                          2.573880             -6.2457192
              OFNS_DESCPOSSESSION OF STOLEN PROPERTY OFNS_DESCRAPE
BROOKLYN                                   -3.548744    -1.9283839
MANHATTAN                                  -1.352005    -0.0922759
QUEENS                                      1.585890     2.5251511
STATEN ISLAND                               2.364024     2.2242799
              OFNS_DESCROBBERY OFNS_DESCSEX CRIMES
BROOKLYN            -2.9691321          -2.0721705
MANHATTAN            0.8240710           0.8196095
QUEENS               2.2911473           3.2508879
STATEN ISLAND        0.5474707           2.8450814
              OFNS_DESCUNAUTHORIZED USE OF A VEHICLE
BROOKLYN                                   -3.973077
MANHATTAN                                  -2.554067
QUEENS                                      1.976917
STATEN ISLAND                              -4.980322
              OFNS_DESCVEHICLE AND TRAFFIC LAWS
BROOKLYN                             -2.3554988
MANHATTAN                             0.6204204
QUEENS                                4.4163541
STATEN ISLAND                         2.3906467

Std. Errors:
              (Intercept) LOC_CLASSFCTN_DESCDWELLING LOC_CLASSFCTN_DESCHOUSING
BROOKLYN         2.475680                  0.2893580                 0.3839506
MANHATTAN        5.546627                  0.3316622                 0.3699146
QUEENS          14.514822                  0.4654247                 0.4438445
STATEN ISLAND   14.445551                  0.8815954                79.2936076
              LOC_CLASSFCTN_DESCOTHER LOC_CLASSFCTN_DESCPARKING LOT
BROOKLYN                 2.636761e-05                     0.8060919
MANHATTAN                3.486555e-01                     0.6111661
QUEENS                   1.206772e+02                     0.7142570
STATEN ISLAND            6.037758e+01                     1.0335359
              LOC_CLASSFCTN_DESCPLAYGROUND LOC_CLASSFCTN_DESCSTREET
BROOKLYN                      6.219333e-01                0.2349476
MANHATTAN                     8.201556e-05                0.2120541
QUEENS                        1.209765e+00                0.2938414
STATEN ISLAND                 7.251280e+01                0.7803210
              LOC_CLASSFCTN_DESCTRANSIT LOC_CLASSFCTN_DESCVEHICLE
BROOKLYN                       1.224717              1.507987e-05
MANHATTAN                      1.658728              2.168612e-05
QUEENS                         1.324996              8.017836e-01
STATEN ISLAND                 15.267480              7.474944e+01
              PERP_RACEBLACK PERP_RACEBLACK HISPANIC PERP_RACEWHITE
BROOKLYN           0.8591915                1.109700   2.083260e-07
MANHATTAN          1.8509230                1.860893   9.154079e-08
QUEENS             4.9026198                4.922927   9.392986e-02
STATEN ISLAND      5.9526968               11.367733   9.395367e-02
              PERP_RACEWHITE HISPANIC PERP_AGE_GROUP18-24 PERP_AGE_GROUP25-44
BROOKLYN                    0.8623001           0.2125433           0.2261244
MANHATTAN                   1.8524455           0.2169528           0.2258099
QUEENS                      4.9038531           0.2546401           0.2659732
STATEN ISLAND               6.9223139           0.3497728           0.6324370
              PERP_AGE_GROUP45-64 PERP_AGE_GROUP65+ VIC_AGE_GROUP18-24
BROOKLYN                0.3395641      1.535295e-05          0.1561677
MANHATTAN               0.3474382      2.096217e-06          0.2255448
QUEENS                  0.4926693      6.521206e-05          0.2445657
STATEN ISLAND           0.5616370      2.267146e-03         13.7793115
              VIC_AGE_GROUP25-44 VIC_AGE_GROUP45-64 VIC_AGE_GROUP65+
BROOKLYN               0.1629780          0.2366768     4.801175e-01
MANHATTAN              0.2276552          0.2661800     1.183092e-04
QUEENS                 0.2538300          0.3512843     1.054845e+02
STATEN ISLAND         13.7795298         13.7853937     9.737610e+01
              VIC_AGE_GROUPUNKNOWN VIC_RACEBLACK VIC_RACEBLACK HISPANIC
BROOKLYN              5.161205e+01     0.5584027              0.5883901
MANHATTAN             9.378493e-01     0.6369578              0.6679914
QUEENS                1.649147e+00     0.6655160              0.6906061
STATEN ISLAND         6.115585e-04    11.1270211             21.2640025
              VIC_RACEUNKNOWN VIC_RACEWHITE VIC_RACEWHITE HISPANIC
BROOKLYN         5.161205e+01     0.7590163              0.5747958
MANHATTAN        9.378493e-01     0.7535498              0.6546495
QUEENS           1.649147e+00     1.0716898              0.6997092
STATEN ISLAND    6.115585e-04    72.6738310             13.7430901
              OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW
BROOKLYN                                   0.03195188
MANHATTAN                                  0.00373652
QUEENS                                     0.03315128
STATEN ISLAND                              0.02474071
              OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES OFNS_DESCBURGLAR'S TOOLS
BROOKLYN                                   3.226219                72.951839
MANHATTAN                                  7.362668                73.249082
QUEENS                                    19.399792                 1.172118
STATEN ISLAND                              7.051969                 1.402493
              OFNS_DESCBURGLARY OFNS_DESCCANNABIS RELATED OFFENSES
BROOKLYN               3.245646                          4.2075654
MANHATTAN              7.369060                         73.0168113
QUEENS                19.413614                         74.7447077
STATEN ISLAND          7.114532                          0.9846135
              OFNS_DESCCHILD ABANDONMENT/NON SUPPORT
BROOKLYN                                    47.05941
MANHATTAN                                   68.45276
QUEENS                                      40.12260
STATEN ISLAND                               47.19064
              OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF
BROOKLYN                                     3.232122
MANHATTAN                                    7.365651
QUEENS                                      19.402064
STATEN ISLAND                                7.107213
              OFNS_DESCCRIMINAL TRESPASS OFNS_DESCDANGEROUS DRUGS
BROOKLYN                        3.292041                 3.227059
MANHATTAN                       7.390535                 7.362477
QUEENS                         19.413347                19.401125
STATEN ISLAND                  30.821715                 7.045238
              OFNS_DESCDANGEROUS WEAPONS OFNS_DESCFELONY ASSAULT
BROOKLYN                        3.232650                3.228272
MANHATTAN                       7.366141                7.363642
QUEENS                         19.401294               19.400077
STATEN ISLAND                   7.062158                7.048412
              OFNS_DESCFOR OTHER AUTHORITIES OFNS_DESCFORGERY OFNS_DESCFRAUDS
BROOKLYN                            3.286651         3.322337        3.337766
MANHATTAN                           7.381994         7.404837        7.625587
QUEENS                             39.317347        19.438595        9.163893
STATEN ISLAND                      46.269632        39.037878        7.146960
              OFNS_DESCGAMBLING OFNS_DESCGRAND LARCENY
BROOKLYN               3.349085               3.243860
MANHATTAN              7.478954               7.372600
QUEENS                19.495055              19.414510
STATEN ISLAND        112.502384               7.073117
              OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE OFNS_DESCHARRASSMENT 2
BROOKLYN                                     3.343023           2.593394e+01
MANHATTAN                                    0.172956           2.552519e+01
QUEENS                                     126.773562           4.993257e+01
STATEN ISLAND                                7.125568           1.242395e-04
              OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE
BROOKLYN                                 2.593394e+01
MANHATTAN                                2.552519e+01
QUEENS                                   4.993257e+01
STATEN ISLAND                            1.242395e-04
              OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING
BROOKLYN                                     3.305236
MANHATTAN                                    7.410816
QUEENS                                      19.417832
STATEN ISLAND                               41.782037
              OFNS_DESCINTOXICATED/IMPAIRED DRIVING
BROOKLYN                                0.024004703
MANHATTAN                               0.004305309
QUEENS                                  0.028436423
STATEN ISLAND                           0.002243371
              OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES
BROOKLYN                                5.211567e-02
MANHATTAN                               2.083543e-02
QUEENS                                  8.297418e-02
STATEN ISLAND                           1.769213e-08
              OFNS_DESCMISCELLANEOUS PENAL LAW
BROOKLYN                              3.229041
MANHATTAN                             7.363806
QUEENS                               19.400214
STATEN ISLAND                         7.050516
              OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE
BROOKLYN                                     3.407450
MANHATTAN                                    7.421784
QUEENS                                      19.421127
STATEN ISLAND                               81.196624
              OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY
BROOKLYN                                  3.3423370
MANHATTAN                                 0.6414121
QUEENS                                   19.4224917
STATEN ISLAND                            69.9382438
              OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;
BROOKLYN                                    3.269627
MANHATTAN                                   7.379333
QUEENS                                     19.416815
STATEN ISLAND                              32.478872
              OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI
BROOKLYN                                     3.233233
MANHATTAN                                    7.366073
QUEENS                                      19.405405
STATEN ISLAND                                7.054856
              OFNS_DESCOFFENSES AGAINST THE PERSON
BROOKLYN                                  3.288078
MANHATTAN                                 7.410257
QUEENS                                   14.786491
STATEN ISLAND                             7.104285
              OFNS_DESCOFFENSES INVOLVING FRAUD
BROOKLYN                               3.261392
MANHATTAN                              7.371974
QUEENS                                53.649051
STATEN ISLAND                          7.070728
              OFNS_DESCOTHER OFFENSES RELATED TO THEF OFNS_DESCOTHER STATE LAWS
BROOKLYN                                     35.67819              3.493044e+00
MANHATTAN                                    36.02008              3.421493e+00
QUEENS                                       37.76761              5.881336e-03
STATEN ISLAND                                81.62285              1.316643e-05
              OFNS_DESCOTHER STATE LAWS (NON PENAL LA
BROOKLYN                                  0.024665650
MANHATTAN                                 0.195414423
QUEENS                                    0.026734043
STATEN ISLAND                             0.004016735
              OFNS_DESCOTHER TRAFFIC INFRACTION OFNS_DESCPETIT LARCENY
BROOKLYN                              3.2717205               3.226571
MANHATTAN                             0.2521706               7.363078
QUEENS                               19.4092622              19.402232
STATEN ISLAND                         7.0922108              23.791050
              OFNS_DESCPOSSESSION OF STOLEN PROPERTY OFNS_DESCRAPE
BROOKLYN                                    3.270239      3.232076
MANHATTAN                                   7.400413      7.370966
QUEENS                                     19.415171     19.403627
STATEN ISLAND                               7.099297      7.058730
              OFNS_DESCROBBERY OFNS_DESCSEX CRIMES
BROOKLYN              3.236635            3.224496
MANHATTAN             7.366055            7.362071
QUEENS               19.403140           19.399242
STATEN ISLAND         7.108963            7.040376
              OFNS_DESCUNAUTHORIZED USE OF A VEHICLE
BROOKLYN                                    3.387518
MANHATTAN                                   7.669677
QUEENS                                     19.433308
STATEN ISLAND                              70.844476
              OFNS_DESCVEHICLE AND TRAFFIC LAWS
BROOKLYN                               3.235327
MANHATTAN                              7.367224
QUEENS                                19.400613
STATEN ISLAND                          7.051979

Residual Deviance: 7293.767 
AIC: 7821.767 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> combined_df)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> combined_df, <span class="at">type =</span> <span class="st">"probs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(combined_df<span class="sc">$</span>BORO, <span class="at">p =</span> <span class="fl">0.80</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> combined_df[index, ]</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> combined_df[<span class="sc">-</span>index, ]</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">multinom</span>(BORO <span class="sc">~</span> LOC_CLASSFCTN_DESC <span class="sc">+</span> PERP_RACE <span class="sc">+</span> PERP_AGE_GROUP <span class="sc">+</span> VIC_AGE_GROUP <span class="sc">+</span> VIC_RACE <span class="sc">+</span> OFNS_DESC <span class="sc">+</span> STATISTICAL_MURDER_FLAG, <span class="at">data =</span> train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  345 (272 variable)
initial  value 4731.747463 
iter  10 value 3503.178937
iter  20 value 3139.207783
iter  30 value 2953.000193
iter  40 value 2920.501733
iter  50 value 2898.352874
iter  60 value 2885.566650
iter  70 value 2881.773075
iter  80 value 2880.241604
iter  90 value 2879.331694
iter 100 value 2878.781392
final  value 2878.781392 
stopped after 100 iterations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1, test_data)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = BORO ~ LOC_CLASSFCTN_DESC + PERP_RACE + PERP_AGE_GROUP + 
    VIC_AGE_GROUP + VIC_RACE + OFNS_DESC + STATISTICAL_MURDER_FLAG, 
    data = train_data)

Coefficients:
              (Intercept) LOC_CLASSFCTN_DESCDWELLING LOC_CLASSFCTN_DESCHOUSING
BROOKLYN        -2.146518                 -0.1093128                  2.902306
MANHATTAN       -6.473590                 -2.4481023                  1.890714
QUEENS          20.134083                 -2.2922430                  1.752026
STATEN ISLAND  -17.556510                  1.9714368                 -5.493919
              LOC_CLASSFCTN_DESCOTHER LOC_CLASSFCTN_DESCPARKING LOT
BROOKLYN                   -23.893864                     14.199892
MANHATTAN                   -1.794555                     16.680180
QUEENS                     -16.667436                     15.116368
STATEN ISLAND              -10.747652                      3.774085
              LOC_CLASSFCTN_DESCPLAYGROUND LOC_CLASSFCTN_DESCSTREET
BROOKLYN                        -0.1811225               -0.2397904
MANHATTAN                      -16.0090564               -1.1973859
QUEENS                          -1.3742855               -1.1429493
STATEN ISLAND                   -8.4548673                0.1423831
              LOC_CLASSFCTN_DESCTRANSIT LOC_CLASSFCTN_DESCVEHICLE
BROOKLYN                       1.484322                -19.107242
MANHATTAN                     -3.292679                -32.238939
QUEENS                         2.588706                 -2.969077
STATEN ISLAND                 -3.338213                -15.899777
              PERP_RACEBLACK PERP_RACEBLACK HISPANIC PERP_RACEWHITE
BROOKLYN            7.744113                3.247179      -1.003382
MANHATTAN           6.106616                4.604333      -2.928040
QUEENS            -22.929612              -25.377144      -9.780928
STATEN ISLAND      -1.063281               -8.183772      22.587221
              PERP_RACEWHITE HISPANIC PERP_AGE_GROUP18-24 PERP_AGE_GROUP25-44
BROOKLYN                     6.611499           -0.808527          -0.1317567
MANHATTAN                    5.298647           -1.681650          -1.2111879
QUEENS                     -22.589849           -2.095049          -1.2027058
STATEN ISLAND               -8.834242           -2.641508          -4.9046214
              PERP_AGE_GROUP45-64 PERP_AGE_GROUP65+ VIC_AGE_GROUP18-24
BROOKLYN                1.1931891        -15.876426          0.1728374
MANHATTAN               0.1602213        -17.702057          1.8033960
QUEENS                 -1.5339371        -14.234391          1.2607504
STATEN ISLAND          -0.4224033         -8.035911          9.7366621
              VIC_AGE_GROUP25-44 VIC_AGE_GROUP45-64 VIC_AGE_GROUP65+
BROOKLYN              -0.4056737        -1.26362284       -1.0508181
MANHATTAN              1.5959349         1.71002678      -15.4423757
QUEENS                 0.7208382         0.02729998      -13.8367142
STATEN ISLAND         10.1200572         8.49974298       -0.9886953
              VIC_AGE_GROUPUNKNOWN VIC_RACEBLACK VIC_RACEBLACK HISPANIC
BROOKLYN                 5.3142387    -0.7481458             -1.3845072
MANHATTAN               -0.8068516     0.6761221             -0.2125031
QUEENS                  -1.6122360    -0.0443992              0.6372399
STATEN ISLAND            2.8888704     7.2215776             -1.9279042
              VIC_RACEUNKNOWN VIC_RACEWHITE VIC_RACEWHITE HISPANIC
BROOKLYN            5.3142387    -1.7827956             -1.7193885
MANHATTAN          -0.8068516     0.8112667             -0.4337374
QUEENS             -1.6122360    -2.7234265             -1.8840204
STATEN ISLAND       2.8888704    -1.4688085             -2.8628012
              OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW
BROOKLYN                                    7.1533901
MANHATTAN                                  -3.6849383
QUEENS                                     -0.6225654
STATEN ISLAND                              -1.4659161
              OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES OFNS_DESCBURGLAR'S TOOLS
BROOKLYN                                 -3.7002146                 6.333434
MANHATTAN                                 0.6428144                10.290644
QUEENS                                    3.6724781                -1.350743
STATEN ISLAND                             0.7091450                -3.089424
              OFNS_DESCBURGLARY OFNS_DESCCANNABIS RELATED OFFENSES
BROOKLYN              -3.037457                         -8.1470470
MANHATTAN              2.477442                          9.0711136
QUEENS               -11.230970                         13.1021441
STATEN ISLAND         -4.983253                         -0.8406538
              OFNS_DESCCHILD ABANDONMENT/NON SUPPORT
BROOKLYN                                  -12.487169
MANHATTAN                                  -9.235221
QUEENS                                     -3.778131
STATEN ISLAND                              -5.258535
              OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF
BROOKLYN                                   -3.6209609
MANHATTAN                                   0.7375183
QUEENS                                      3.5819197
STATEN ISLAND                               1.2560642
              OFNS_DESCCRIMINAL TRESPASS OFNS_DESCDANGEROUS DRUGS
BROOKLYN                      -4.1779051                -3.361069
MANHATTAN                      0.1340611                 1.712954
QUEENS                         3.6735583                 2.905907
STATEN ISLAND                 -5.3634214                 2.170033
              OFNS_DESCDANGEROUS WEAPONS OFNS_DESCFELONY ASSAULT
BROOKLYN                       -2.694582              -3.8130744
MANHATTAN                       1.347981               0.4896463
QUEENS                          4.650627               4.1018737
STATEN ISLAND                   1.922723               1.3192364
              OFNS_DESCFOR OTHER AUTHORITIES OFNS_DESCFORGERY OFNS_DESCFRAUDS
BROOKLYN                          -4.4685234        -2.213307       -5.234425
MANHATTAN                          0.2541088         3.100975       -2.996293
QUEENS                           -11.9172782         4.865304      -12.429417
STATEN ISLAND                     -3.0867606        -2.582698        4.148601
              OFNS_DESCGAMBLING OFNS_DESCGRAND LARCENY
BROOKLYN              -3.600756              -1.983301
MANHATTAN            -12.988477               1.829555
QUEENS               -11.093505               3.212098
STATEN ISLAND         -7.763179               3.959566
              OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE OFNS_DESCHARRASSMENT 2
BROOKLYN                                    -3.989540            -1.88080823
MANHATTAN                                  -13.215488             2.59851506
QUEENS                                      -9.182676            -0.08860018
STATEN ISLAND                                2.816785            -0.23857935
              OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE
BROOKLYN                                  -1.88080823
MANHATTAN                                  2.59851506
QUEENS                                    -0.08860018
STATEN ISLAND                             -0.23857935
              OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING
BROOKLYN                                   -3.3678704
MANHATTAN                                   0.8970642
QUEENS                                      4.5793578
STATEN ISLAND                               0.5030909
              OFNS_DESCINTOXICATED/IMPAIRED DRIVING
BROOKLYN                                 9.51340115
MANHATTAN                               -3.47669376
QUEENS                                  -1.38906737
STATEN ISLAND                           -0.04257432
              OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES
BROOKLYN                                  7.76907156
MANHATTAN                                -3.62951650
QUEENS                                   -3.23552602
STATEN ISLAND                             0.08935855
              OFNS_DESCMISCELLANEOUS PENAL LAW
BROOKLYN                             -3.308168
MANHATTAN                             1.472545
QUEENS                                4.725227
STATEN ISLAND                         3.132129
              OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE
BROOKLYN                                   -4.6194542
MANHATTAN                                   0.3550014
QUEENS                                      5.2138069
STATEN ISLAND                              -6.2755695
              OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY
BROOKLYN                                  -3.492195
MANHATTAN                                -11.938423
QUEENS                                     5.039218
STATEN ISLAND                             -5.756350
              OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;
BROOKLYN                                  -4.2093926
MANHATTAN                                  0.5358206
QUEENS                                     3.0449111
STATEN ISLAND                             -4.4216863
              OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI
BROOKLYN                                    -3.691392
MANHATTAN                                    0.855199
QUEENS                                       2.372726
STATEN ISLAND                                1.841734
              OFNS_DESCOFFENSES AGAINST THE PERSON
BROOKLYN                                 -3.793365
MANHATTAN                                -0.770833
QUEENS                                  -10.575724
STATEN ISLAND                             3.364396
              OFNS_DESCOFFENSES INVOLVING FRAUD
BROOKLYN                              -3.064854
MANHATTAN                              2.415442
QUEENS                               -11.477095
STATEN ISLAND                          2.909383
              OFNS_DESCOTHER OFFENSES RELATED TO THEF OFNS_DESCOTHER STATE LAWS
BROOKLYN                                     7.662265                 10.239124
MANHATTAN                                   13.085895                 16.594447
QUEENS                                      16.483556                 -2.879258
STATEN ISLAND                                5.375914                  1.091540
              OFNS_DESCOTHER STATE LAWS (NON PENAL LA
BROOKLYN                                    -5.624621
MANHATTAN                                   12.965977
QUEENS                                      -1.617776
STATEN ISLAND                               -0.199738
              OFNS_DESCOTHER TRAFFIC INFRACTION OFNS_DESCPETIT LARCENY
BROOKLYN                              -2.659233              -3.153541
MANHATTAN                            -12.061717               1.186028
QUEENS                                 5.192685               2.690120
STATEN ISLAND                          3.772165              -6.094685
              OFNS_DESCPOSSESSION OF STOLEN PROPERTY OFNS_DESCRAPE
BROOKLYN                                  -4.2643469    -2.1881134
MANHATTAN                                 -0.2623194     0.7356188
QUEENS                                     3.5399091     4.3999827
STATEN ISLAND                              2.7556775     3.0794828
              OFNS_DESCROBBERY OFNS_DESCSEX CRIMES
BROOKLYN             -3.452018           -2.605254
MANHATTAN             1.363987            1.467735
QUEENS                3.283629            4.769984
STATEN ISLAND        -8.781300            3.549472
              OFNS_DESCUNAUTHORIZED USE OF A VEHICLE
BROOKLYN                                   -4.601805
MANHATTAN                                 -13.273329
QUEENS                                      3.382233
STATEN ISLAND                              -4.354869
              OFNS_DESCVEHICLE AND TRAFFIC LAWS STATISTICAL_MURDER_FLAGTRUE
BROOKLYN                              -2.946093                  -0.7820746
MANHATTAN                              1.191736                  -0.5757025
QUEENS                                 5.867746                  -1.2109765
STATEN ISLAND                          2.792957                   0.4756664

Std. Errors:
              (Intercept) LOC_CLASSFCTN_DESCDWELLING LOC_CLASSFCTN_DESCHOUSING
BROOKLYN         2.951500                  0.3293157                 0.4528975
MANHATTAN        8.857252                  0.3794156                 0.4400561
QUEENS          11.855579                  0.5605715                 0.5228155
STATEN ISLAND   28.158260                  0.9974192                29.0344212
              LOC_CLASSFCTN_DESCOTHER LOC_CLASSFCTN_DESCPARKING LOT
BROOKLYN                 6.358781e-08                     0.7596509
MANHATTAN                3.987156e-01                     0.5560607
QUEENS                   7.179495e-05                     0.7312205
STATEN ISLAND            1.253506e+02                     0.1085088
              LOC_CLASSFCTN_DESCPLAYGROUND LOC_CLASSFCTN_DESCSTREET
BROOKLYN                      6.685929e-01                0.2666536
MANHATTAN                     7.880913e-05                0.2444464
QUEENS                        1.228447e+00                0.3402541
STATEN ISLAND                 1.572004e+02                0.8655484
              LOC_CLASSFCTN_DESCTRANSIT LOC_CLASSFCTN_DESCVEHICLE
BROOKLYN                       1.259768              3.588927e-05
MANHATTAN                      1.702279              1.383654e-09
QUEENS                         1.376224              8.794983e-01
STATEN ISLAND                 38.947234              1.279164e-02
              PERP_RACEBLACK PERP_RACEBLACK HISPANIC PERP_RACEWHITE
BROOKLYN            1.013828                1.240519   3.202957e-08
MANHATTAN           2.954075                2.962722   2.442500e-08
QUEENS              9.609683                9.621443   3.704814e+01
STATEN ISLAND      13.385269               21.556817   3.704823e+01
              PERP_RACEWHITE HISPANIC PERP_AGE_GROUP18-24 PERP_AGE_GROUP25-44
BROOKLYN                     1.017125           0.2407564           0.2567850
MANHATTAN                    2.955270           0.2461922           0.2560642
QUEENS                       9.610764           0.2878970           0.3000674
STATEN ISLAND               16.541704           0.4215734           0.7762188
              PERP_AGE_GROUP45-64 PERP_AGE_GROUP65+ VIC_AGE_GROUP18-24
BROOKLYN                0.3890563      1.537207e-06          0.1761289
MANHATTAN               0.3981154      6.931520e-07          0.2500089
QUEENS                  0.5749505      5.873341e-06          0.2778752
STATEN ISLAND           0.6731332      1.758152e-03         17.1096297
              VIC_AGE_GROUP25-44 VIC_AGE_GROUP45-64 VIC_AGE_GROUP65+
BROOKLYN               0.1868417          0.2691324     5.924860e-01
MANHATTAN              0.2545963          0.2985742     1.275646e-06
QUEENS                 0.2909374          0.4061590     6.513327e-06
STATEN ISLAND         17.1103096         17.1161905     5.603086e-01
              VIC_AGE_GROUPUNKNOWN VIC_RACEBLACK VIC_RACEBLACK HISPANIC
BROOKLYN              9.275372e-04     0.5945874              0.6333720
MANHATTAN             8.186505e-06     0.7076537              0.7433487
QUEENS                3.925878e-06     0.7077718              0.7394094
STATEN ISLAND         7.694055e-07    28.5926334             48.2677331
              VIC_RACEUNKNOWN VIC_RACEWHITE VIC_RACEWHITE HISPANIC
BROOKLYN         9.275364e-04     0.8269810              0.6136193
MANHATTAN        8.186465e-06     0.8517956              0.7268673
QUEENS           3.925917e-06     1.1312314              0.7486450
STATEN ISLAND    7.694055e-07   123.1288222             33.9078839
              OFNS_DESCALCOHOLIC BEVERAGE CONTROL LAW
BROOKLYN                                  0.008848374
MANHATTAN                                 0.006507624
QUEENS                                    0.002590460
STATEN ISLAND                             0.005717858
              OFNS_DESCASSAULT 3 &amp; RELATED OFFENSES OFNS_DESCBURGLAR'S TOOLS
BROOKLYN                                   3.865742              6.211995419
MANHATTAN                                 11.784757              5.159167283
QUEENS                                     9.927821              0.008386864
STATEN ISLAND                              8.864106              0.014965031
              OFNS_DESCBURGLARY OFNS_DESCCANNABIS RELATED OFFENSES
BROOKLYN              3.8907100                          3.0630601
MANHATTAN            11.7909587                         87.1956462
QUEENS                0.1085707                         83.1895735
STATEN ISLAND        59.6379610                          0.4110919
              OFNS_DESCCHILD ABANDONMENT/NON SUPPORT
BROOKLYN                                   94.343122
MANHATTAN                                   3.404727
QUEENS                                     92.726629
STATEN ISLAND                              88.961533
              OFNS_DESCCRIMINAL MISCHIEF &amp; RELATED OF
BROOKLYN                                     3.873293
MANHATTAN                                   11.787146
QUEENS                                       9.933475
STATEN ISLAND                                8.906723
              OFNS_DESCCRIMINAL TRESPASS OFNS_DESCDANGEROUS DRUGS
BROOKLYN                        3.936446                 3.866536
MANHATTAN                      11.807377                11.784491
QUEENS                          9.957702                 9.931093
STATEN ISLAND                  43.380179                 8.858677
              OFNS_DESCDANGEROUS WEAPONS OFNS_DESCFELONY ASSAULT
BROOKLYN                        3.872897                3.868331
MANHATTAN                      11.787484               11.785686
QUEENS                          9.931219                9.928609
STATEN ISLAND                   8.879602                8.861646
              OFNS_DESCFOR OTHER AUTHORITIES OFNS_DESCFORGERY OFNS_DESCFRAUDS
BROOKLYN                          3.93268600         4.028987      3.99604922
MANHATTAN                        11.80096210        11.835755     11.97565113
QUEENS                            0.09337143        10.024701      0.05567465
STATEN ISLAND                    36.39416605        29.495469      8.93631331
              OFNS_DESCGAMBLING OFNS_DESCGRAND LARCENY
BROOKLYN              4.0216393               3.882244
MANHATTAN             0.3952151              11.791835
QUEENS                0.1489874               9.979665
STATEN ISLAND         0.7592275               8.879830
              OFNS_DESCGRAND LARCENY OF MOTOR VEHICLE OFNS_DESCHARRASSMENT 2
BROOKLYN                                    3.9699956           5.886246e+01
MANHATTAN                                   0.1512345           5.879638e+01
QUEENS                                      0.4519393           1.165362e+02
STATEN ISLAND                               8.9246135           3.814225e-06
              OFNS_DESCHOMICIDE-NEGLIGENT,UNCLASSIFIE
BROOKLYN                                 5.886246e+01
MANHATTAN                                5.879638e+01
QUEENS                                   1.165362e+02
STATEN ISLAND                            3.814225e-06
              OFNS_DESCINTOXICATED &amp; IMPAIRED DRIVING
BROOKLYN                                     3.949458
MANHATTAN                                   11.815044
QUEENS                                       9.961334
STATEN ISLAND                               65.129017
              OFNS_DESCINTOXICATED/IMPAIRED DRIVING
BROOKLYN                               0.0066604336
MANHATTAN                              0.0010458381
QUEENS                                 0.0006186597
STATEN ISLAND                          0.0002489974
              OFNS_DESCKIDNAPPING &amp; RELATED OFFENSES
BROOKLYN                                3.206902e-03
MANHATTAN                               4.653508e-03
QUEENS                                  1.314227e-03
STATEN ISLAND                           1.282223e-09
              OFNS_DESCMISCELLANEOUS PENAL LAW
BROOKLYN                              3.869217
MANHATTAN                            11.785631
QUEENS                                9.929189
STATEN ISLAND                         8.861721
              OFNS_DESCMURDER &amp; NON-NEGL. MANSLAUGHTE
BROOKLYN                                     4.039504
MANHATTAN                                   11.833297
QUEENS                                       9.978467
STATEN ISLAND                               87.105464
              OFNS_DESCNYS LAWS-UNCLASSIFIED FELONY
BROOKLYN                                  3.9731151
MANHATTAN                                 0.3847745
QUEENS                                    9.9697175
STATEN ISLAND                           100.4575389
              OFNS_DESCOFF. AGNST PUB ORD SENSBLTY &amp;
BROOKLYN                                    3.915338
MANHATTAN                                  11.798397
QUEENS                                      9.962789
STATEN ISLAND                              38.609735
              OFNS_DESCOFFENSES AGAINST PUBLIC ADMINI
BROOKLYN                                     3.873452
MANHATTAN                                   11.787446
QUEENS                                       9.944758
STATEN ISLAND                                8.873449
              OFNS_DESCOFFENSES AGAINST THE PERSON
BROOKLYN                                 3.9239016
MANHATTAN                               11.8358576
QUEENS                                   0.2145147
STATEN ISLAND                            8.9033708
              OFNS_DESCOFFENSES INVOLVING FRAUD
BROOKLYN                             3.89713495
MANHATTAN                           11.79147978
QUEENS                               0.09306089
STATEN ISLAND                        8.88500860
              OFNS_DESCOTHER OFFENSES RELATED TO THEF OFNS_DESCOTHER STATE LAWS
BROOKLYN                                     6.322559              5.690928e+00
MANHATTAN                                    8.473908              5.643199e+00
QUEENS                                       7.008843              1.257076e-04
STATEN ISLAND                                1.105098              1.528404e-07
              OFNS_DESCOTHER STATE LAWS (NON PENAL LA
BROOKLYN                                 0.0379815986
MANHATTAN                                0.2380272153
QUEENS                                   0.0015094372
STATEN ISLAND                            0.0007595514
              OFNS_DESCOTHER TRAFFIC INFRACTION OFNS_DESCPETIT LARCENY
BROOKLYN                              3.9230781               3.865699
MANHATTAN                             0.2825846              11.785006
QUEENS                                9.9530404               9.936396
STATEN ISLAND                         8.9133799              32.786516
              OFNS_DESCPOSSESSION OF STOLEN PROPERTY OFNS_DESCRAPE
BROOKLYN                                    3.920369      3.871629
MANHATTAN                                  11.810450     11.790576
QUEENS                                      9.958030      9.935399
STATEN ISLAND                               8.904518      8.867556
              OFNS_DESCROBBERY OFNS_DESCSEX CRIMES
BROOKLYN              3.875050            3.863811
MANHATTAN            11.787180           11.784198
QUEENS                9.939187            9.927201
STATEN ISLAND       132.092705            8.853128
              OFNS_DESCUNAUTHORIZED USE OF A VEHICLE
BROOKLYN                                   4.0099560
MANHATTAN                                  0.1169506
QUEENS                                     9.9917379
STATEN ISLAND                             83.0285714
              OFNS_DESCVEHICLE AND TRAFFIC LAWS STATISTICAL_MURDER_FLAGTRUE
BROOKLYN                               3.874650                   0.1484112
MANHATTAN                             11.788050                   0.1556714
QUEENS                                 9.929746                   0.2363697
STATEN ISLAND                          8.864815                   0.3833775

Residual Deviance: 5757.563 
AIC: 6293.563 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(predictions <span class="sc">==</span> test_data<span class="sc">$</span>BORO)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy:"</span>, accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy: 0.592896174863388"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> predictions, <span class="at">Actual =</span> test_data<span class="sc">$</span>BORO)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

               Actual
Predicted       BRONX BROOKLYN MANHATTAN QUEENS STATEN ISLAND
  BRONX           134       35        27     14             0
  BROOKLYN         27      117        47     19             5
  MANHATTAN        19       46       157     22             8
  QUEENS            8       15         2     19             0
  STATEN ISLAND     1        0         3      0             7

Overall Statistics
                                          
               Accuracy : 0.5929          
                 95% CI : (0.5563, 0.6287)
    No Information Rate : 0.3224          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.4369          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: BRONX Class: BROOKLYN Class: MANHATTAN
Sensitivity                0.7090          0.5493           0.6653
Specificity                0.8600          0.8112           0.8085
Pos Pred Value             0.6381          0.5442           0.6230
Neg Pred Value             0.8946          0.8143           0.8354
Prevalence                 0.2582          0.2910           0.3224
Detection Rate             0.1831          0.1598           0.2145
Detection Prevalence       0.2869          0.2937           0.3443
Balanced Accuracy          0.7845          0.6802           0.7369
                     Class: QUEENS Class: STATEN ISLAND
Sensitivity                0.25676             0.350000
Specificity                0.96201             0.994382
Pos Pred Value             0.43182             0.636364
Neg Pred Value             0.92006             0.981969
Prevalence                 0.10109             0.027322
Detection Rate             0.02596             0.009563
Detection Prevalence       0.06011             0.015027
Balanced Accuracy          0.60938             0.672191</code></pre>
</div>
</div>
<section id="section-1.5-offense-descriptions" class="level2">
<h2 class="anchored" data-anchor-id="section-1.5-offense-descriptions">Section 1.5: Offense Descriptions</h2>
<p>The horizontal bar chart presents a breakdown of various types of offenses. The most frequent offense, represented by the longest bar, is “Vehicle and Traffic Laws,” suggesting a high number of incidents related to traffic violations. “Sex Crimes” and “Robbery” follow, indicating significant occurrence rates within the dataset. Offenses like “Rape” and “Petit Larceny” show lower counts but are still notable. Other categories, including “Offenses Involving Fraud,” “Offenses Against Public Administration,” and “Miscellaneous Penal Law,” display moderate counts. This variable could be instrumental for law enforcement prioritization and public awareness initiatives.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>